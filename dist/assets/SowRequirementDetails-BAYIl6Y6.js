import{a6 as A,a7 as H,al as D,am as b,a9 as d,af as M,ac as N,a8 as y,ab as _,ao as E,ag as W,aj as F,au as w,ak as z,T as i,aC as J,ax as v,aB as Q,O as K,U as X,ay as Y}from"./index-BmmqEUwr.js";import{Q as Z}from"./QSkeleton-Coym0GAQ.js";import{L as ee}from"./ListQTable-CU9pwRms.js";import{u as te}from"./use-quasar-jxPryvnm.js";import{Q as ae}from"./QCardDetails-C0QU-irT.js";import{U as oe,S as se,a as le}from"./SowGuidelineRequirement-YAwDBBtx.js";import{I as ie}from"./Introspection-BfTNXc1Q.js";import"./QSelect-BiYUipAn.js";import"./use-key-composition-DGnxYdx2.js";import"./QChip-CEk8Ad1K.js";import"./QItemLabel-Da11J6wT.js";import"./QDialog-DNaj6pyy.js";import"./QToggle-CHdCZyvb.js";import"./dark-mode-CG8Py2TO.js";import"./index-DO6kqxPy.js";import"./parser-4S4bR1x6.js";import"./QMarkupTable-CqW4FPo6.js";import"./ClosePopup-Dl7x5pRy.js";import"./QPagination-BPciSIuB.js";import"./QCard-71HNS0Eo.js";import"./QSeparator-DcnsD_Wj.js";import"./QCardSection-W7OKuTbN.js";import"./QCardActions-gAV4t4Gq.js";import"./QFile-Dpo0hu6w.js";const ne=H({components:{ListQTable:ee,QCardDetails:ae},setup(){const a=F(),o=w({editMode:!1,name:"",blockHours:"",skillId:"",projectProcessId:"",taskType:"",selectedRequirement:{},description:"",page:1,totalPages:0,showCardDetails:!0,deleteRoot:!1,search:"",showModal:!1,textResponse:null,booleanResponse:null,fileUploadResponse:null}),p=z(),f=i([]),g=i(null),R=i(!0),{result:l,error:c,load:P}=J(se,()=>({sow_id:g.value,page:o.page,first:15}));v(()=>{c.value&&console.log(c.value,"errReq"),l.value&&(R.value=!1,f.value=l.value.SowGuidelineRequirements.data,o.totalPages=l.value.SowGuidelineRequirements.paginatorInfo.lastPage)});const n=i({}),{result:r,error:k}=Q(le,()=>({_id:a.params.id}));v(()=>{k.value&&console.log(k.value,"error"),r.value&&(n.value={...r.value.SowGuidelineRequirement,RequirementId:r.value.SowGuidelineRequirement._id,S3Url:null,Download:r.value.SowGuidelineRequirement.S3Url},o.name=n.value.Name,o.description=n.value.Description,g.value=r.value.SowGuidelineRequirement.sow_id,P())});const u=w([{name:"name",align:"left",label:"Name",field:e=>e.RequirementName,format:e=>`${e}`,sortable:!0},{name:"Description",align:"left",label:"Description",field:e=>e.RequirementDescription?e.RequirementDescription:"N/A",format:e=>`${e}`,sortable:!0},{name:"requirementStatus",align:"left",label:"Status",field:e=>e.text_Response||e.fileOriginalName?"Completed":"Not Started",format:e=>`${e}`,sortable:!0},{name:"attachment",align:"right",label:"Actions"}]),s=w([{name:"name",align:"left",label:"Name",field:e=>e.Name,format:e=>`${e}`,sortable:!0},{name:"process",required:!0,label:"Project Process",align:"left",field:e=>e.ProjectProcessName,format:e=>`${e}`,sortable:!0},{name:"skillName",required:!0,label:"Skill",align:"left",field:e=>e.SkillName?e.SkillName:"N/A",format:e=>`${e}`,sortable:!0},{name:"block",required:!0,label:"Block Hours",align:"left",field:e=>e.BlockHours?e.BlockHours+" hrs":"0 hrs",format:e=>`${e}`,sortable:!0},{name:"actions",label:"Actions"}]),m=K("windowWidth"),$=()=>{if(m.value<=850){const e=s.findIndex(t=>t.name==="block");e!==-1&&s.splice(e,1)}else s.find(t=>t.name==="block")||s.splice(3,0,{name:"block",required:!0,label:"Block Hours",align:"left",field:t=>t.BlockHours?t.BlockHours+" hrs":"0 hrs",format:t=>`${t}`,sortable:!0});if(m.value<=780){const e=s.findIndex(t=>t.name==="skillName");e!==-1&&s.splice(e,1)}else s.find(t=>t.name==="skillName")||s.splice(2,0,{name:"skillName",required:!0,label:"Skill",align:"center",field:t=>t.SkillName?t.SkillName:"N/A",format:t=>`${t}`,sortable:!0});if(m.value<=530){const e=s.findIndex(t=>t.name==="process");e!==-1&&s.splice(e,1)}else s.find(t=>t.name==="process")||s.splice(1,0,{name:"process",required:!0,label:"Project Process",align:"left",field:t=>t.ProjectProcessName,format:t=>`${t}`,sortable:!0})},x=()=>{if(m.value<=700){const e=u.findIndex(t=>t.name==="Description");e!==-1&&u.splice(e,1)}else u.find(t=>t.name==="Description")||u.splice(1,0,{name:"Description",align:"left",label:"Description",field:t=>t.RequirementDescription?t.RequirementDescription:"N/A",format:t=>`${t}`,sortable:!0})};X(()=>m.value,()=>{$(),x()},{immediate:!0});const S=i(-1);function I(e){p.push({name:"SowRequirementDetails",params:{id:e}}),S.value=-1,o.showCardDetails=!1,setTimeout(()=>{o.showCardDetails=!0},500)}const{mutate:B,onDone:V,onError:U}=Y(oe,()=>({variables:{_id:a.params.id,text_Response:o.textResponse,fileUploadResponse:o.fileUploadResponse}}));V(e=>{console.log(e,"Res"),o.textResponse=null,o.fileUploadResponse=null}),U(e=>{console.log(e,"error")});function G(e){o.textResponse=e.text_Response,o.fileUploadResponse=e.fileOriginalName,B(),T.notify({color:"indigo",textColor:"white",icon:"edit",message:"Requirement Updated"})}const T=te();function O(e){o.showModal=e}const j=["text_Response","fileOriginalName"];function L(e){o.page=e}const{result:q,error:h}=Q(ie,()=>({name:"SowGuidelineRequirement"})),C=i([]);return v(()=>{h.value&&console.log(JSON.stringify(h.value,null,2)),q.value&&(console.log(q.value,"introspectionData for SOWREQ"),q.value.__type.fields.map(e=>{e.description!==null&&C.value.push(e)}))}),{state:o,loading:R,setPage:L,requirements:f,columns:s,requirementColumns:u,requirementValue:n,goToSowRequirement:I,setShowModal:O,editableFields:j,requirementData:l,routeChangeAmount:S,updateRequirement:G,introspectionValue:C,returnToSow(){p.push({name:"SowDetails",params:{id:n.value.sow_id}})}}}}),re={style:{"border-radius":"5px"},class:"w-full px-5 sm:px-10"},ue={style:{},class:"intro-y box w-full"},me={key:0,class:"mb-8 text-center text-2xl text-slate-600 dark:text-slate-300"},de={key:1,class:"flex justify-center"};function ce(a,o,p,f,g,R){const l=D("QCardDetails"),c=D("ListQTable");return d(),b("div",re,[M("div",ue,[N(E,{label:"Return to SOW","no-caps":"",icon:"arrow_back",color:"primary",class:"q-ma-md absolute top-[-1.5rem] ml-0 shadow-sm shadow-blue-400",flat:"",onClick:a.returnToSow},null,8,["onClick"]),a.loading?(d(),b("div",de,[a.loading?(d(),y(Z,{key:0,class:"mb-8 h-3 w-80"})):_("",!0)])):(d(),b("p",me,W(a.requirementValue.RequirementName),1)),a.state.showCardDetails?(d(),y(l,{key:2,response:a.requirementValue,editableFields:a.editableFields,updateResponse:a.updateRequirement,removeOptions:["delete"],introspectionValue:a.introspectionValue,isLoading:a.loading},null,8,["response","editableFields","updateResponse","introspectionValue","isLoading"])):_("",!0),N(c,{title:"SOW Related Requirements",rows:a.requirements,columns:a.requirementColumns,stateValue:a.state,setPage:a.setPage,loading:a.state.searchLoading,handleRowClick:a.goToSowRequirement},null,8,["rows","columns","stateValue","setPage","loading","handleRowClick"])])])}const Ge=A(ne,[["render",ce]]);export{Ge as default};
