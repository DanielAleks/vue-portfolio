import{a6 as U,a7 as B,am as d,a9 as c,a8 as j,ab as m,aa as N,ac as s,af as o,ah as A,ag as n,ao as H,au as V,ak as R,o as q,T as b,aB as C,ax as w,ay as I,U as J}from"./index-D5yNAYFk.js";import{Q as P}from"./QCardSection-Bxs731jM.js";import{Q as r}from"./QToggle-DbLruOcG.js";import{Q as L}from"./QSelect-BmmHhKDO.js";import{Q as O}from"./QCard-CbW7iEIi.js";import{u as z}from"./use-quasar-DBA3fETA.js";import{A as F}from"./AccountNotification-Bo67RKc9.js";import{a as G}from"./Account-D0LxHc_o.js";import{D as K,U as W}from"./AccountNotification-Bqj0E0Pf.js";import"./use-key-composition-COT35ogy.js";import"./QChip-DHC18oyq.js";import"./QItemLabel-Cx7oXb7e.js";import"./QDialog-B5BoQEQA.js";import"./index-B22rUDyO.js";import"./parser-Dz45C1v8.js";const X=B({name:"MyPreferences",setup(){const t=V({totalPages:10,high:!1,medium:!1,low:!1,critical:!1,info:!1,email:!1,sms:!1,severityArray:[],isSIEM:!1,notificationTypes:[],accountID:null,notificationTypeID:null,unwatchItem:!1}),e=R();let f="",p="";try{f=q.getItem("userData"),p=JSON.parse(f)}catch(l){console.log(l)}const a=b([]),{result:u,loading:i,error:T}=C(F,()=>({contact_id:p._id})),k=V([{name:"Contact Preferences",description:"How shall Project Central notify you on important updates"},{name:"Notification Priority",description:"Set the priority of notifications that this user will receive"},{name:"Remove Notification Account",description:"This will remove the Notification Preferences for this user"}]);w(()=>{u.value&&(console.log(u.value.AccountNotifications.data[0],"AccountNotifications"),a.value=u.value.AccountNotifications.data[0],a.value.NotificationTypes.includes("SIEM")&&(t.unwatchItem=!0,t.isSIEM=!0,t.notificationTypes=["SIEM"],y.value=["SIEM"],setTimeout(()=>{t.unwatchItem=!1},500)),t.accountID=a.value.account_id,t.severityArray=a.value.severity,t.email=a.value.send_email,t.sms=a.value.send_sms)});const{result:v}=C(G,()=>({autotask_id:t.accountID})),y=b([]);w(()=>{v.value&&v.value.Company&&(y.value=v.value.Company.AvailableNotifications)});const{mutate:S}=I(W,()=>({variables:{_id:a.value._id,send_email:t.email,send_sms:t.sms,severity:t.severityArray,siem_notification_id:t.notificationTypeID}}));function g(l){l!=="email"&&l!=="sms"&&l!=="notificationType"&&(t.severityArray.includes(l)?t.severityArray=t.severityArray.filter(E=>E!==l):t.severityArray=[...t.severityArray,l]),S()}const{mutate:D,onDone:M}=I(K,()=>({variables:{_id:a.value._id}})),Q=z();M(()=>{Q.notify({message:"Notification Account Deleted",color:"red-5",icon:"check"}),e.push({path:"/accounts"})});const $=b([{label:"---",value:"---"},{label:"SIEM",value:"SIEM"}]);function h(l){t.notificationTypeID=l[0],g("notificationType")}return J(()=>t.notificationTypes,()=>{t.unwatchItem||h(t.notificationTypes)}),{state:t,notifications:k,accountNotifications:u,loading:i,error:T,userNotifications:a,updateAccountNotification:g,deleteAccountNotification:D,options:$,hasAvailableNotifications:y,updateAvailableNotification:h}},data(){return{notify:!1}}}),Y={class:"mx-10 w-full"},Z={class:"pt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3"},x={class:"col-span-2"},_={class:"text-lg"},tt={class:"text-slate-700"},et={class:"mt-1 flex flex-col items-start mt-4 sm:mt-0 sm:items-end w-full mr-4"},ot={class:"text-slate-500"},it={class:"text-slate-700"},st={class:"text-slate-500"},at={class:"text-slate-700"},lt={class:"relative"},nt={key:0,class:"flex absolute right-0 top-0"},rt={class:"text-slate-500 mt-2"},ut={href:"https://www.aislabs.com/getting-started/service-level-objective/",class:"flex justify-end"},ct={class:"mb-3 pt-3 border-t"},dt={class:"flex"},mt={class:"flex flex-col ml-10"},ft={key:0,class:"my-5"},pt={key:1,class:"flex"},vt={class:"flex flex-col ml-10"},yt={class:"flex"},Nt={class:"grid grid-cols-2 gap-1 ml-10"},At={class:"flex flex-col"},bt={class:"flex flex-col"};function gt(t,e,f,p,a,u){return c(),d("div",Y,[t.accountNotifications?(c(),j(O,{key:0,class:"border animate__fadeIn",style:{"animation-duration":"0.5s"}},{default:N(()=>[s(P,null,{default:N(()=>[o("div",Z,[o("div",x,[o("p",_,n(t.userNotifications.ContactName),1),o("p",tt,n(t.userNotifications.ContactEmail),1)]),o("div",et,[o("p",ot,[e[15]||(e[15]=A(" AccountName: ",-1)),o("span",it,n(t.userNotifications.AccountName),1)]),o("p",st,[e[16]||(e[16]=A(" Primary Phone: ",-1)),o("span",at,n(t.userNotifications.ContactPrimaryPhone?t.userNotifications.ContactPrimaryPhone:"N/A"),1)])])]),e[18]||(e[18]=o("hr",{class:"my-4"},null,-1)),A(" "+n(t.loading)+" error: "+n(t.error)+" ",1),o("div",lt,[e[17]||(e[17]=o("p",{class:"text-lg bold mt-3"},"Account Notification Preferences",-1)),t.accountNotifications?(c(),d("div",nt)):m("",!0),o("p",rt," Set "+n(t.userNotifications.ContactName)+"'s preferences for important notifications about their account ",1),o("a",ut,[s(H,{label:"More Info...",color:"primary",flat:"",dense:"",class:"py-0 absolute right-5 top-12 mt-2 md:top-0","no-caps":""})])])]),_:1}),s(P,null,{default:N(()=>[o("div",ct,[o("div",dt,[e[19]||(e[19]=o("div",{class:""},[o("p",{class:"text-semisbold"},"Contact Preferences"),o("p",{class:"text-slate-500 mt-2"}," How shall Project Central notify this user on important updates ")],-1)),o("div",mt,[s(r,{modelValue:t.state.email,"onUpdate:modelValue":e[0]||(e[0]=i=>t.state.email=i),label:"Email",onClick:e[1]||(e[1]=i=>t.updateAccountNotification("email"))},null,8,["modelValue"]),s(r,{modelValue:t.state.sms,"onUpdate:modelValue":e[2]||(e[2]=i=>t.state.sms=i),label:"SMS",onClick:e[3]||(e[3]=i=>t.updateAccountNotification("sms"))},null,8,["modelValue"])])]),t.hasAvailableNotifications.length>0?(c(),d("hr",ft)):m("",!0),t.hasAvailableNotifications.length>0?(c(),d("div",pt,[e[20]||(e[20]=o("div",{class:""},[o("p",{class:"text-semisbold"},"Available Notifications"),o("p",{class:"text-slate-500 mt-2"}," Select the notifications that this user will receive ")],-1)),o("div",vt,[s(L,{modelValue:t.state.notificationTypes,"onUpdate:modelValue":e[4]||(e[4]=i=>t.state.notificationTypes=i),options:t.options,label:"Notification Type",filled:"","emit-value":"","map-options":"",class:"ml-3 sm:ml-14 mt-4 w-60",dense:""},null,8,["modelValue","options"])])])):m("",!0),e[22]||(e[22]=o("hr",{class:"my-5"},null,-1)),o("div",yt,[e[21]||(e[21]=o("div",{class:""},[o("p",{class:"text-semisbold"},"Notification Priority"),o("p",{class:"text-slate-500 mt-2"}," Set the priority of notifications that this user will receive ")],-1)),o("div",Nt,[o("div",At,[s(r,{modelValue:t.state.high,"onUpdate:modelValue":e[5]||(e[5]=i=>t.state.high=i),label:"High",onClick:e[6]||(e[6]=i=>t.updateAccountNotification(1))},null,8,["modelValue"]),s(r,{modelValue:t.state.medium,"onUpdate:modelValue":e[7]||(e[7]=i=>t.state.medium=i),label:"Medium",onClick:e[8]||(e[8]=i=>t.updateAccountNotification(2))},null,8,["modelValue"]),s(r,{modelValue:t.state.low,"onUpdate:modelValue":e[9]||(e[9]=i=>t.state.low=i),label:"Low",onClick:e[10]||(e[10]=i=>t.updateAccountNotification(3))},null,8,["modelValue"])]),o("div",bt,[s(r,{modelValue:t.state.critical,"onUpdate:modelValue":e[11]||(e[11]=i=>t.state.critical=i),label:"Critical",onClick:e[12]||(e[12]=i=>t.updateAccountNotification(0))},null,8,["modelValue"]),s(r,{modelValue:t.state.info,"onUpdate:modelValue":e[13]||(e[13]=i=>t.state.info=i),label:"Information",onClick:e[14]||(e[14]=i=>t.updateAccountNotification(4))},null,8,["modelValue"])])])])])]),_:1})]),_:1})):m("",!0)])}const Bt=U(X,[["render",gt]]);export{Bt as default};
