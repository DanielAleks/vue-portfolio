import{Q as ia}from"./QSkeleton-B7rOYwnS.js";import{a6 as de,a7 as me,al as U,a8 as G,a9 as m,aa as S,af as r,aK as sa,ae as W,ac as c,ah as te,ag as E,ao as A,ab as y,az as Ae,au as le,aj as pe,E as V,U as Re,aB as H,ay as B,T as p,ax as Z,am as P,ap as ra,ai as De,ad as Ee,Q as ue,ak as Ve,a3 as ke,aq as ve,ar as he,aM as ua,aL as da,a4 as ma,aC as pa,O as Qe}from"./index-CQCl7-n1.js";import{u as ge,Q as re}from"./dark-mode-D-GqxvW3.js";import{Q as ca}from"./QItemLabel-4PS5Ii4A.js";import{Q as Ue,C as fa}from"./ClosePopup-TnQGvSW-.js";import{Q as va}from"./QToggle-X9yPZq_d.js";import{Q as Le}from"./QDialog-0UbYXYZ9.js";import{u as Me}from"./use-quasar-CeTCeS0j.js";import{S as Ne}from"./SearchModel-hS4W0wni.js";import{I as ha}from"./ImplementationGuideline-CqFIZU6q.js";import{M as je,C as ka,R as ga}from"./ImplementationTask-Bcn5SXyP.js";import{I as Fe}from"./ImplementationTask-D6cNH7wg.js";import{e as He,f as ya,g as Ta,h as Sa,i as Ia,j as wa,a as Ca}from"./searchStore-u7vDWyEa.js";import{Q as We}from"./QCard-D9NvINpq.js";import{a as ba}from"./Skill-B9WEagu0.js";import{M as Da,U as Ra,a as Ma,R as Na}from"./ImplementationGuideline-CICQC675.js";import{L as Pa}from"./ListQTable-DoGh3vFW.js";import{u as _a,s as qa}from"./pinia-Cu7h5Kzx.js";import{Q as Ga}from"./QCardDetails-6q-DwPz1.js";import{B as Ba}from"./BasicAttachModal-Vgo0mwAq.js";import{P as $a}from"./Product-DVpbQSbo.js";import{S as Oa}from"./Service-DnWyiXFb.js";import{S as Qa}from"./ServiceBundle-CAXrjvpX.js";import{R as Aa}from"./Requirement-DtbUlzwp.js";import{a as Ea}from"./AdminImplementationGuideline-bbOEaRM6.js";import{I as Va}from"./Introspection-FbDfCq5f.js";import{C as Ua,U as La,a as ja,b as Fa,D as Ha,c as Wa,d as za,e as Ka,f as Ya}from"./ImplementationGuidelineServiceBundle-BJzu0Lg_.js";import{b as Ja}from"./ImplementationType-BbCNiKng.js";import{A as Xa}from"./AccordianQTableDeep-lJkkXWjo.js";import{C as Za}from"./ImplementationTaskRequirement-K-EsuIoo.js";import"./use-key-composition-B6EajJfj.js";import"./index-BAc7fDxH.js";import"./parser-C_oP7G4F.js";import"./QResizeObserver-CpFCL3bZ.js";import"./QScrollObserver-D1yOb7nN.js";import"./touch-BjYP5sR0.js";import"./search-DNJIg9HY.js";import"./QSelect-CZoYKFij.js";import"./QChip-tlUzG03O.js";import"./QMarkupTable-DiNkxTl4.js";import"./QPagination-OEL0QgjP.js";import"./QSeparator-DqL40xTU.js";import"./QCardSection-CUOYl02q.js";import"./QCardActions-BYtFZJPE.js";import"./QFile-BzE_8x3B.js";import"./QExpansionItem-DYaZX0kV.js";import"./QSlideTransition-C100Y9TG.js";const xa=me({name:"CreateGuidelineTaskModal",components:{SearchModel:Ne},props:{guideline:{type:Object,required:!0},setShowModal:{type:Function,required:!0},showModal:{type:[Boolean,String],required:!0},refetchTasks:{type:Function,default:()=>{}},route:{type:Object,default:()=>{}},pushCreatedTask:{type:Function,default:()=>{}}},setup(e){const n=le({showModal:!1,isCreateNew:!1,skill_id:null,project_process_id:null,skillCategory:"",skillDescription:"",skillName:"",selectedGuideline:e.guideline&&e.guideline._id,guidelineName:e.guideline&&e.guideline.ShortName,resetSkillName:0,name:"",blockHours:0,isRecurring:!1,isCustomerTask:!1,taskType:"",skillTier:"",selectedTaskID:null,shouldResetSearch:!1}),R=pe();function w(i){i!=="close"&&(n.skillName=i.Name,n.skill_id=i._id,n.skillCategory=i.Category,n.skillDescription=i.Description)}function f(i){i!=="close"&&(n.project_process_id=i._id)}const C=V(()=>ge().darkmode);Re(()=>e.showModal,()=>{e.showModal===!0?(n.showModal=!0,D("another")):D("close")});const{result:T}=H(ha,()=>({implementation_type_idNew:e.route.query.id,filterOutExistingSowGuidelines:!0,first:15}));function D(i){i!=="another"&&(n.showModal=!1),n.name="",n.skillTier="",n.taskType="",n.blockHours=0,n.isRecurring=!1,n.isCustomerTask=!1,n.isCreateNew=!1,$.setSearch(""),$.setPage(1)}function _(i,g){n.isCreateNew?u():v(),z(n.name),setTimeout(g!=="another"?()=>{e.setShowModal(!1),D("close")}:()=>{D("another"),n.shouldResetSearch=!n.shouldResetSearch},100)}const{mutate:v,onDone:M,onError:o}=B(je,()=>({variables:{_id:n.selectedTaskID,action:"add",_ids:[e.route.params.id],relatedModel:"ImplementationGuideline"}}));M(i=>{console.log(i,"onDone");let g={...i.data.ManageRelationshipsImplementationTaskMutation,ProjectProcessName:i.data.ManageRelationshipsImplementationTaskMutation.ProjectProcess.Name};e.pushCreatedTask(g)}),o(i=>{console.log("ERROR",i.value)});const{mutate:u,onDone:ae,onError:x}=B(ka,()=>({variables:{Name:n.name,BlockHours:parseInt(n.blockHours),IsRecurring:n.isRecurring,skill_id:n.skill_id,project_process_id:n.project_process_id,TaskType:n.TaskType,SkillTier:n.SkillTier,isCustomerTask:n.isCustomerTask}}));ae(i=>{console.log(i,"onDone");const g={...i.data.CreateImplementationTaskMutation,ProjectProcessName:i.data.CreateImplementationTaskMutation.ProjectProcess.Name};e.pushCreatedTask(g)}),x(i=>{console.log(i,"result ERROR")});const d=Me();function z(i){d.notify({spinner:!0,message:"Task Attached: "+i,timeout:3e3,icon:"done",color:"green"})}function K(i){n.selectedGuideline=i._id,n.guidelineName=i.ShortName}function L(){e.setShowModal(!1),n.showModal=!1}function ne(i,g){i!=="close"&&(g==="search"||(n.selectedTaskID=i._id,n.name=i.Name))}const $=He(),{result:O,loading:j}=H(Fe,()=>({Name:$.search,page:$.page,first:15,implementation_guideline_idNew:R.params.id,filterOutAllExistingTasks:!0})),I=p([]),s=p(!1),k=p("");return Z(()=>{if(j.value&&(s.value=!0),$.search!==k.value&&(s.value=!0,I.value=[],k.value=$.search),O.value){s.value=!1;let i=I.value;const g=O.value.ImplementationTasks.data.filter(q=>!I.value.some(b=>b._id===q._id));$.page>1?I.value=[...I.value,...g]:I.value=[...g,...I.value],$.setSpinner(I.value,i)}}),$.onSetValueCallback(ne),{state:n,createSowComponent:_,setSkillId:w,guidelines:T,setAssociatedGuideline:K,hideModal:L,setProjectProcessId:f,setTaskID:ne,tasks:I,searchOptions:$,isLoadingTasks:s,darkmode:C}}}),en={class:"relative z-10"},tn={class:"fixed inset-0 z-10"},an={class:"col flex flex-col mb-0 mx-5"},nn={class:"mr-3 mt-2 mb-2"},on={class:"flex text-start pb-16"},ln={class:"flex",style:{position:"absolute",right:"0px",bottom:"1rem"}},sn={class:"flex"};function rn(e,n,R,w,f,C){const T=U("SearchModel");return m(),G(Le,{modelValue:e.state.showModal,"onUpdate:modelValue":n[3]||(n[3]=D=>e.state.showModal=D)},{default:S(()=>[r("div",en,[r("div",tn,[r("div",{class:"mt-0 flex flex-col min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",onClick:n[2]||(n[2]=sa(D=>e.hideModal(!1),["self"]))},[r("div",{class:W(["relative transform text-left sm:mt-8 w-full sm:max-w-lg pb-3",e.darkmode?"bg-[#28334E] text-slate-300":"bg-white"]),style:{"border-radius":"5px 5px 0px 0px"}},[r("div",an,[n[5]||(n[5]=r("p",{class:"text-xl my-4 text-center"},"Attach a Implementation Task",-1)),n[6]||(n[6]=r("hr",{style:{width:"100%"},class:"dark:border-slate-500"},null,-1)),r("span",nn,[n[4]||(n[4]=te("Associated Guideline: ",-1)),r("b",null,E(e.guideline.Name),1)]),c(T,{label:"Implementation Tasks",rows:e.tasks,loading:e.isLoadingTasks,filled:"","no-focus":"",store:e.searchOptions,resetSearch:e.state.shouldResetSearch},null,8,["rows","loading","store","resetSearch"])])],2),r("div",{class:W(["px-5 flex-col sm:px-6 relative w-full sm:w-[32rem]",e.darkmode?"bg-[#28334E] text-slate-300":"bg-white"]),style:{"border-radius":"0px 0px 10px 10px"}},[r("div",on,[r("div",ln,[c(A,{dense:"",class:"save-btn q-px-md mr-3","no-caps":"",flat:"",label:e.state.name!==""?"Add Another":"Cancel",color:e.state.name!==""?e.darkmode?"grey-5":"grey-7":"red-5",onClick:n[0]||(n[0]=D=>e.state.name!==""?e.createSowComponent(e.cardAddMode,"another"):e.hideModal(!1))},null,8,["label","color"]),r("div",sn,[c(A,{dense:"",class:"save-btn q-px-md",style:{"margin-right":"1.5rem","margin-left":"0rem"},"no-caps":"",icon:"add",label:"Create New",color:"blue-grey",href:"implementation-task/create",target:"_blank"}),r("div",null,[c(A,{dense:"",disable:e.state.name===""&&e.state.selectedTaskID===null,class:"save-btn q-px-md",style:{"margin-right":"1.5rem","margin-left":"0rem"},"no-caps":"",label:"Save & Close",color:"primary",onClick:n[1]||(n[1]=D=>e.createSowComponent(e.cardAddMode,"close"))},null,8,["disable"]),e.state.name===""&&e.state.selectedTaskID===null?(m(),G(Ae,{key:0,class:"text-sm bg-white shadow-md border text-slate-600"},{default:S(()=>[...n[7]||(n[7]=[te(" Task Name cannot be Empty ",-1)])]),_:1})):y("",!0)])])])])],2)])])])]),_:1},8,["modelValue"])}const un=de(xa,[["render",rn]]),dn=me({props:{item:{type:Object,default:()=>{}},pushNewSkillData:{type:Function,default:()=>{}},refetchSkillData:{type:Function,default:()=>{}}},setup(e){const n=V(()=>ge().darkmode),{result:R,error:w}=H(ba,()=>({autotask_id:e.item.skill_id})),f=pe(),{mutate:C,onDone:T}=B(Da,()=>({variables:{_id:f.params.id,action:"remove",relatedModel:"Skill",_ids:e.item.autotask_id}}));T(u=>{console.log(u),e.refetchSkillData()});const D=Me();function _(u){D.notify({spinner:!0,message:"Skill Unassigned: "+u,timeout:500,color:"indigo-9"})}function v(){C(),_(R.value.Skill.name),e.pushNewSkillData(R.value.Skill,"delete"),console.log(R.value.Skill,"skill.value.Skill")}const M=Ve();function o(){M.push({name:"GuidelineSkillDetails",params:{id:e.item.skill_id}})}return{skill:R,error:w,deleteGuidelineSkill:v,goToSkill:o,darkmode:n}}}),mn={key:0},pn={class:"font-medium whitespace-nowrap flex"},cn=["href"],fn={class:"flex items-center absolute right-5"},vn={class:"text-slate-500 dark:text-slate-400 text-xs mt-0.5"},hn={class:"mb-2"},kn={class:""};function gn(e,n,R,w,f,C){return m(),G(We,{class:W(["box relative p-3 rounded h-full",e.darkmode?"bg-[#28334E] text-slate-300":"bg-white border"])},{default:S(()=>[e.skill?(m(),P("div",mn,[r("a",pn,[r("a",{class:"mt-5 sm:mt-0 cursor-pointer",href:"/implementation-type/skill/"+e.skill.Skill.autotask_id},E(e.skill.Skill.name),9,cn),r("div",fn,[r("div",{class:W([e.skill.Skill.isActive?"bg-primary":"bg-red","w-2 h-2 rounded-full"])},null,2),r("p",{class:W([e.skill.Skill.isActive?"text-primary":"text-red-400 italic","mr-5 ml-2"])},E(e.skill.Skill.isActive?"Active":"Deprecated"),3),c(A,{class:"absolute right-[-1rem] top-[-.25rem]",round:"",flat:"",icon:"more_vert",dense:"",size:"md"},{default:S(()=>[c(ra,{cover:"","auto-close":""},{default:S(()=>[c(Ue,null,{default:S(()=>[c(De,{clickable:"",onClick:e.deleteGuidelineSkill},{default:S(()=>[c(Ee,{style:{width:"3.5rem",display:"flex"},class:"flex"},{default:S(()=>[...n[0]||(n[0]=[te("Unassign",-1)])]),_:1})]),_:1},8,["onClick"]),c(De,{clickable:"",class:"flex items-center",onClick:e.goToSkill},{default:S(()=>[n[1]||(n[1]=r("p",{class:"mr-3"},"View",-1)),c(ue,{name:"visibility"})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])]),r("div",vn,[r("p",hn,"Category: "+E(e.skill.Skill.CategoryName),1),r("p",kn," Description: "+E(e.skill.Skill.Description?e.skill.Skill.Description:"N/A"),1)])])):y("",!0)]),_:1},8,["class"])}const yn=de(dn,[["render",gn]]),Tn=me({name:"SearchComponent",components:{SearchModel:Ne},props:{setValue:{type:Function,required:!0},dense:{type:Boolean,default:!1},placeholder:{type:String,default:null},filled:{type:Boolean,default:!1},noFocus:{type:Boolean,default:!1},setCreateNew:{type:Function,default:()=>{}},type:{type:String,required:!0}},setup(e){const n=le({search:"",isMenuOpenTemplate:!0,menuOpen:!1,page:1,isCreateNew:!1}),R=pe(),w=ya(),f=Ta(),C=Sa(),T=Ia(),D=He(),_=wa(),v=V(()=>(w.setSearch(""),f.setSearch(""),C.setSearch(""),T.setSearch(""),D.setSearch(""),_.setSearch(""),w.setPage(1),f.setPage(1),C.setPage(1),T.setPage(1),D.setPage(1),_.setPage(1),e.type==="Product"?w:e.type==="Service"?f:e.type==="Service Bundle"?C:e.type==="Task"?T:e.type==="Vulnerability Scan"?D:e.type==="Requirement"?_:w)),M=p([]),o=p([]),u=p(!1);ke(()=>{v.value.onSetValueCallback(ne),o.value=[],e.type==="Product"?ae():e.type==="Service"?x():e.type==="Service Bundle"?d():e.type=="Requirement"&&K()});const ae=async()=>{const{result:s,loading:k}=H($a,()=>({name:w.search,page:w.page,first:20,implementation_guideline_idNew:R.params.id,filterOutAllExistingProducts:!0})),i=p("");Z(()=>{if(k.value&&(u.value=!0),w.search!==i.value&&(u.value=!0,o.value=[],i.value=w.search),s.value){console.log(s.value,"PRODUCTS"),u.value=!1;const g=o.value;if(s.value&&s.value.Products){const q=s.value.Products.data.filter(b=>!o.value.some(Q=>Q.autotask_id===b.autotask_id));w.page>1?o.value=[...o.value,...q]:o.value=[...q,...o.value],w.setSpinner(o.value,g)}}})},x=async()=>{const{result:s,loading:k}=H(Oa,()=>({name:f.search,page:f.page,first:20,implementation_guideline_idNew:R.params.id,filterOutAllExistingServices:!0})),i=p("");Z(()=>{if(k.value&&(u.value=!0),f.search!==i.value&&(u.value=!0,o.value=[],i.value=f.search),s.value){u.value=!1;const g=o.value,q=s.value.Services.data.filter(b=>!o.value.some(Q=>Q.autotask_id===b.autotask_id));s.value&&s.value.Services&&(f.page>1?o.value=[...o.value,...q]:o.value=[...q,...o.value],f.setSpinner(o.value,g))}})},d=async()=>{const{result:s,loading:k,error:i}=H(Qa,()=>({name:C.search,page:C.page,first:20,implementation_guideline_idNew:R.params.id,filterOutAllExistingServiceBundles:!0})),g=p("");Z(()=>{if(k.value&&(u.value=!0),i.value&&console.log(i.value),C.search!==g.value&&(u.value=!0,o.value=[],g.value=C.search),s.value){u.value=!1;const q=o.value;if(s.value&&s.value.ServiceBundles){const b=s.value.ServiceBundles.data.filter(Q=>!o.value.some(oe=>oe.autotask_id===oe.autotask_id===Q.autotask_id));C.page>1?o.value=[...o.value,...b]:o.value=[...b,...o.value],C.setSpinner(o.value,q)}}})},z=async()=>{const{result:s,loading:k,error:i}=H(Fe,()=>({Name:T.search,page:T.page,first:20})),g=p("");Z(()=>{k.value&&(u.value=!0),T.search!==g.value&&(u.value=!0,M.value=[],g.value=T.search),s.value&&(u.value=!1,M.value=s.value.ImplementationTasks.data),i.value&&console.log("error",i.value)})},K=async()=>{const{result:s,loading:k,error:i}=H(Aa,()=>({Name:_.search,page:_.page,first:20})),g=p("");Z(()=>{if(k.value&&(u.value=!0),_.search!==g.value&&(u.value=!0,o.value=[],g.value=_.search),s.value){u.value=!1;const q=o.value,b=s.value.Requirements.data.filter(Q=>!o.value.some(oe=>oe._id===Q._id));s.value&&s.value.Requirements&&(_.page>1?o.value=[...o.value,...b]:o.value=[...b,...o.value],_.setSpinner(o.value,q))}i.value&&console.log("error",i.value)})},L=async(s,k)=>{s===n.page&&(n.page++,v.value.setPage(n.page),setTimeout(()=>{k()},500))};Re(()=>n.search,()=>{O(async()=>{n.page=1,M.value=[],e.setValue(n.search,"search"),v.value.setSearch(n.search)},500)});function ne(s){console.log(s,"setSearchInput"),s.Name===void 0&&s.__typename==="VulnerabilityScan"?n.search=s.DomainName:n.search=s.Name,e.setValue(s,"item"),n.isMenuOpenTemplate=!1,setTimeout(()=>{n.isMenuOpenTemplate=!0},500)}ke(async()=>{z()});let $;const O=(s,k)=>{clearTimeout($),$=setTimeout(s,k)};function j(){n.isCreateNew=!0,n.menuOpen=!1,e.setCreateNew()}const I=V(()=>e.type==="Product"||e.type==="Service"?!0:e.type==="Service Bundle");return{state:n,setSearchInput:ne,implementationTasks:M,fetchImplementationTasks:z,loadQuery:L,setIsCreateNew:j,componentResult:o,isLoading:u,searchOptionsType:v,computedComponentType:I}}});function Sn(e,n,R,w,f,C){const T=U("SearchModel");return m(),G(T,{dense:e.dense,label:e.type+"s",value:e.type!=="Vulnerability Scan"?e.computedComponentType?"name":"Name":"DomainName",rows:e.componentResult,placeholder:e.placeholder?e.placeholder:null,popupWidth:"20rem",filled:!0,loading:e.isLoading,perPageAmount:20,noFocus:e.noFocus,store:e.searchOptionsType},null,8,["dense","label","value","rows","placeholder","loading","noFocus","store"])}const In=de(Tn,[["render",Sn]]),wn=me({name:"BasicAttachModal",props:{showComponentModal:{type:Boolean,default:!1},setComponentModal:{type:Function,default:()=>{}},title:{type:String,default:""},deleteComponent:{type:Function,required:!0},width:{type:String,default:"30rem"},cardAddMode:{type:String,default:""},pushNewResponseData:{type:Function,default:()=>{}},fetchRequirements:{type:Function,default:()=>{}},taskName:{type:String,default:""},createOnly:{type:Boolean,default:!1},saveComponent:{type:Function,default:()=>{}},selectedComponentID:{type:[Number,String],default:null},createNewHref:{type:String,default:null},showHeaderDescription:{type:Boolean,default:!0},saveButtonText:{type:String,default:""},saveButtonTooltip:{type:String,default:""},message:{type:String,default:""},message2:{type:String,default:""},parentComponent:{type:Number,default:null},detachedComponent:{type:Number,default:null}},setup(e){const n=pe(),R=V(()=>parseInt(n.params.id)),w=V(()=>ge().darkmode),f=le({name:"",description:"",componentId:null,showModal:!1,discoveryQuestion:"",responseType:"Boolean",isCreateNew:!1,componentSearch:"",isMenuOpen:!1,page:1,showSpinner:!1,previousRequirementIds:[]}),C=V(()=>e.selectedComponentID===null);ke(()=>{f.showModal=!0});function T(o,u){e.saveComponent(),setTimeout(()=>{u!=="another"&&(f.showModal=!1,e.setComponentModal(!1))},1e3),u==="another"?document.body.style.cursor="wait":setTimeout(()=>{e.setComponentModal(!1),f.showModal=!1,document.body.style.cursor="wait"},1e3),setTimeout(()=>{document.body.style.cursor="default"},1001)}function D(){f.isCreateNew=!0,f.isMenuOpen=!1}function _(o){f.componentId=o._id,f.name=o.detail,f.componentSearch=o.detail,f.isMenuOpen=!1,f.isCreateNew=!1}const v=async(o,u)=>{o===f.page&&(f.page++,setTimeout(()=>{u()},500))};function M(o){o!=="close"&&(f.name=o,f.componentId=o.id)}return{loadQuery:v,state:f,createSowComponent:T,setCreateNew:D,disableCreate:C,setComponentValue:_,sow_id:R,setRequirementId:M,darkmode:w}}}),Cn={class:"p-0"},bn={class:"p-5"},Dn={class:"text-slate-500 dark:text-slate-300 mt-5 mb-2"},Rn={class:"mb-4"},Mn={class:"text-sky-300"},Nn={class:"text-sky-300"},Pn={class:"px-5 pb-5 text-center"};function _n(e,n,R,w,f,C){return m(),G(Le,{modelValue:e.state.showModal,"onUpdate:modelValue":n[1]||(n[1]=T=>e.state.showModal=T),onHide:n[2]||(n[2]=T=>e.setComponentModal(!1))},{default:S(()=>[c(We,{class:W(["container intro-y box w-80 px-2 flex flex-col items-center",e.darkmode?"bg-[#28334E]":""]),dark:e.darkmode},{default:S(()=>[r("div",Cn,[r("div",bn,[n[3]||(n[3]=r("div",{class:"text-3xl mt-5 text-center"},"Are you sure?",-1)),r("div",Dn,[r("p",Rn,[te(E(e.message)+" ",1),r("span",Mn,[r("b",null,E(e.detachedComponent),1)])]),r("p",null,[te(E(e.message2)+" ",1),r("span",Nn,[r("b",null,E(e.parentComponent),1)])])])]),r("div",Pn,[c(A,{class:"btn btn-outline-secondary w-24 mr-2",label:"Cancel",flat:"",onClick:n[0]||(n[0]=T=>e.setComponentModal(!1))}),c(A,{class:"btn btn-outline-secondary w-24 mr-2",color:"red-5",label:"Delete",onClick:e.deleteComponent},null,8,["onClick"])])])]),_:1},8,["dark","class"])]),_:1},8,["modelValue"])}const qn=de(wn,[["render",_n],["__scopeId","data-v-bf1655c7"]]),Gn=me({components:{CreateGuidelineTaskModal:un,MiniCardContainer:yn,ListQTable:Pa,QCardDetails:Ga,BasicAttachModal:Ba,SearchComponent:In,SearchModel:Ne,AccordianQTableDeep:Xa,DeleteConfirmationModal:qn},setup(){const e=_a(qa),n=V(()=>e.taskID);function R(t){e.setTaskID(t)}const w=V(()=>e.implementationID);function f(t){e.setImplementationID(t)}const C=V(()=>e.guidelineID);function T(t){e.setGuidelineID(t)}function D(){e.setAdminSearch(!1)}const _=V(()=>ge().darkMode),v=pe(),M=Ve(),o=le({name:"",id:v.query.id,skill_id:null,showSkillModal:!1,showTaskModal:!1,showUpdateTaskModal:!1,limit:10,page:1,guideline_id:v.query.id,showModal:!1,selectedComponentID:null,searchProduct:"",searchService:"",searchServiceBundle:"",searchTask:"",quantity:1,isOptional:!1,implementationTypeName:"",showQuasarComponent:"button-toggle",showComponentType:"all",showTasksTable:!1,selectedImplementationTask:null,selectedComponentItem:{}}),u=Me(),ae=p({}),x=p(!0);function d(t){o.showTaskModal=t}function z(){o.id=v.query.id}z();function K(t){o.showSkillModal=t}const{result:L,load:ne,error:$}=pa(Ea,()=>({_id:v.params.id})),O=p([]),j=p({}),I=p([]),s=p([]),k=p([]),i=p([]),g=p([]),q=p([]),b=p([]),Q=p(!1),oe=p(!1);Z(()=>{if($.value&&console.log($.value,"ERROR"),L.value){x.value=!1;const t=L.value.AdminImplementationGuideline;if(j.value={...t,IsDeprecated:t.IsDeprecated??"No",isDraft:t.isDraft??"No",Total:t.ImpGuidelineSubtotal??0,ImplementationType:t.ImplementationType&&t.ImplementationType.Name,QualificationQuestion:t.QualificationQuestion===null||t.QualificationQuestion===""?t.Question:t.QualificationQuestion},!Q.value&&(Q.value=!0,console.log(L.value,"guidelineData"),w.value!==t.ImplementationType_id&&f(t.ImplementationType_id),C.value!==t._id&&T(t._id),D(),j.value.IsDeprecated||delete j.value.IsDeprecatedReason,!oe.value)){oe.value=!0,t.ImplementationGuidelineProducts.map(a=>{I.value.some(h=>h.autotask_id===a.autotask_id)||I.value.push({...a.Product,_id:a._id,Quantity:a.quantity,IsOptional:a.IsOptional,product_id:a.Product.autotask_id})}),t.ImplementationGuidelineServices.map(a=>{s.value.some(h=>h._id===a._id)||s.value.push({...a.Service,_id:a._id,Quantity:a.Quantity,IsOptional:a.IsOptional,service_id:a.Service.autotask_id})}),t.ImplementationGuidelineServiceBundles.map(a=>{k.value.some(h=>h._id===a._id)||k.value.push({...a.ServiceBundle,_id:a._id,Quantity:a.Quantity,IsOptional:a.IsOptional,service_bundle_id:a.ServiceBundle.autotask_id})});const l=p([]);t.AdminImplementationTasks.map(a=>{g.value.push({...a,ImplementationTaskName:a.Name,ImplementationTaskRequirements:a.ImplementationTaskRequirements}),l.value.some(h=>h._id===a.ProjectProcess._id)||l.value.push(a.ProjectProcess)}),l.value.map(a=>{i.value.push({...a,ProjectProcessName:a.Name,ImplementationTasks:t.AdminImplementationTasks.filter(h=>h.ProjectProcess._id===a._id),relatedItems:t.AdminImplementationTasks.filter(h=>h.ProjectProcess._id===a._id)}),t.AdminImplementationTasks.map(h=>{q.value.some(N=>N._id===h._id)||q.value.push({...h,relatedItems:h.ImplementationTaskRequirements.filter(N=>N.Requirement)}),h.ImplementationTaskRequirements.map(N=>{N.Requirement&&O.value.push({...N,RequirementName:N.Requirement.Name,Name:N.Requirement.Name,Description:N.Requirement.Description,RelatedImplementationTask:h})})}),O.value=O.value.filter((h,N)=>O.value.findIndex(be=>be._id===h._id)===N),console.log(O.value,"REQUIREMENTS VALUE")}),console.log(i.value,"guidelinePhaseTasks VALUE"),b.value=t.Skills.map(a=>({...a,skill_id:a&&a.autotask_id})),console.log(b.value,"SKILLS VALUE")}}});const{mutate:ze,onDone:Ke,onError:Ye}=B(je,()=>({variables:{_id:o.selectedComponentID,action:"remove",_ids:[v.params.id],relatedModel:"ImplementationGuideline"}}));Ke(t=>{console.log("onDoneDeleteImplementationTask",t,i.value),i.value.map(l=>{l.ImplementationTasks.map((a,h)=>{a._id===t.data.ManageRelationshipsImplementationTaskMutation._id&&l.ImplementationTasks.splice(h,1)})}),u.notify({message:"Task Detached: "+t.data.ManageRelationshipsImplementationTaskMutation.Name,color:"primary",icon:"delete",timeout:4e3})}),Ye(t=>{console.log("ERROR",t)});const{result:se,error:Pe}=H(Va,()=>({_id:v.params.id,name:"ImplementationGuideline"})),ye=p([]);Z(()=>{Pe.value&&console.log(JSON.stringify(Pe.value,null,2)),se.value&&(se.value.__type.fields.map(t=>{t.description!==null&&ye.value.push(t)}),se.value.__type.description.includes("Confluence")&&ye.value.push({name:"Confluence Article",description:se.value.__type.description.substring(19,se.value.__type.description.length)}))});const Te=p({}),{mutate:_e,onDone:Je,onError:Xe}=B(Ra,()=>({variables:Te.value}));Je(()=>{Q.value=!1}),Xe(t=>{console.log(t,"err updateGuidelineMutation")});const{mutate:Ze,onDone:xe}=B(Ma,()=>({variables:{_id:v.params.id}})),qe=p(null),{mutate:et,onDone:tt}=B(Na,()=>({variables:{_id:qe.value}})),ce=p(!1);xe(t=>{j.value=t.data.DeleteImplementationGuidelineMutation,u.notify({message:"Implementation Guideline Deleted: "+t.data.DeleteImplementationGuidelineMutation.Name,color:"primary",icon:"delete",timeout:6e3,actions:[{label:"Undo",color:"white",handler:()=>at(t.data.DeleteImplementationGuidelineMutation._id)}]}),setTimeout(()=>{ce.value||u.loading.show({delay:200,message:"Redirecting to Implementation Guidelines",spinnerSize:100,spinnerColor:"primary",messageColor:"white",backgroundColor:"primary"})},6e3),setTimeout(()=>{ce.value||(u.loading.hide(),M.push("/implementation-guidelines")),ce.value=!1},7e3)}),tt(t=>{j.value=t.data.RestoreImplementationGuidelineMutation,u.notify({message:"Implementation Guideline Restored: "+t.data.RestoreImplementationGuidelineMutation.Name,color:"green",icon:"redo",timeout:4e3})});function at(t){qe.value=t,ce.value=!0,et()}function nt(t,l){l!=="delete"?(Te.value={_id:v.params.id,...t},_e()):Ze()}function ot(t){o.page=t}const Y=le([{name:"name",align:"left",label:"Name",field:t=>t.Name,format:t=>`${t}`,sortable:!0},{name:"block",required:!0,label:"Block Hours",align:"center",field:t=>(t.BlockHours??0)+" hrs",format:t=>`${t}`,sortable:!0},{name:"skillName",required:!0,label:"Skill",align:"center",field:t=>t.SkillTier?t.SkillTier:"N/A",format:t=>`${t}`,sortable:!0},{name:"attachment",label:"Actions"}]),Ge=Qe("formatTotal"),J=le([{name:"name",align:"left",label:"Name",field:t=>t.name,format:t=>`${t}`},{name:"quantity",required:!0,label:"Quantity",align:"center",field:t=>t.Quantity??t.quantity,format:t=>`${t}`},{name:"periodType",label:"Period Type",align:"center",field:t=>t.PeriodType==="m"?"Monthly":t.PeriodType==="y"?"Yearly":t.PeriodType==="o"?"One-Time":t.PeriodTypeName},{name:"isOptional",required:!0,label:"Is Optional",align:"center",field:t=>t.IsOptional===!0?"Yes":"No",format:t=>`${t}`},{name:"price",required:!0,label:"Price",align:"left",field:t=>Ge(t.unitPrice),format:t=>`${t}`},{name:"attachment",label:"Actions",align:"right"}]),Se=Qe("windowWidth"),lt=()=>{if(Se.value<=800){const t=Y.findIndex(a=>a.name==="block");t!==-1&&Y.splice(t,1);const l=J.findIndex(a=>a.name==="price");l!==-1&&J.splice(l,1)}else Y.find(a=>a.name==="block")||Y.splice(3,0,{name:"block",required:!0,label:"Block Hours",align:"center",field:a=>(a.BlockHours?a.BlockHours:0)+" hrs",format:a=>`${a}`,sortable:!0}),J.find(a=>a.name==="price")||J.splice(4,0,{name:"price",required:!0,label:"Price",align:"left",field:a=>Ge(a.UnitPrice),format:a=>`${a}`,sortable:!0});if(Se.value<=600){const t=Y.findIndex(a=>a.name==="skillName");t!==-1&&Y.splice(t,1);const l=J.findIndex(a=>a.name==="periodType");l!==-1&&J.splice(l,1)}else Y.find(a=>a.name==="skillName")||Y.splice(2,0,{name:"skillName",required:!0,label:"Skill",align:"center",field:a=>a.SkillName?a.SkillName:"N/A",format:a=>`${a}`,sortable:!0}),J.find(a=>a.name==="periodType")||J.splice(2,0,{name:"periodType",label:"Period Type",align:"center",field:a=>a.PeriodType==="m"?"Monthly":a.PeriodType==="y"?"Yearly":a.PeriodType==="o"?"One-Time":a.PeriodType})};Re(()=>Se.value,()=>{lt()},{immediate:!0});function it(t,l,a){console.log(t,l,a,"goToTaskDetails"),l==="delete"?t.__typename.includes("Requirement")?(o.selectedComponentID=t._id,F.value={...t,RelatedImplementationTask:{Name:"Task",_id:t.implementation_task_idNew}},$e()):(o.selectedComponentID=t._id,ze()):a&&(a.ctrlKey||a.button===1||a==="openNewTab")?window.open(`implementation-type/task/${t}`,"_blank"):a==="openNewWindow"?window.open(`implementation-type/task/${t}`,"_blank","width=full,height=full"):a==="openIncognitoWindow"?window.open(`implementation-type/task/${t}`,"_blank","incognito=yes"):a&&a.button!==2?(R(t),M.push({name:"ImplementationTaskDetails",params:{id:t}})):(R(t),M.push({name:"ImplementationTaskDetails",params:{id:t}}))}function st(t,l,a){l==="delete"?(o.selectedComponentID=t._id,It()):a.ctrlKey||a.button===1||a==="openNewTab"?window.open(`implementation-type/product/${l.product_id}`,"_blank"):a==="openNewWindow"?window.open(`implementation-type/product/${l.product_id}`,"_blank","width=full,height=full"):a==="openIncognitoWindow"?window.open(`implementation-type/product/${l.product_id}`,"_blank","incognito=yes"):a.button!==2&&M.push({name:"Product Details",params:{id:l.product_id}})}function rt(t,l,a){l==="delete"?(o.selectedComponentID=t._id,Mt()):a.ctrlKey||a.button===1||a==="openNewTab"?window.open(`implementation-type/service/${l.service_id}`,"_blank"):a==="openNewWindow"?window.open(`implementation-type/service/${l.service_id}`,"_blank","width=full,height=full"):a==="openIncognitoWindow"?window.open(`implementation-type/service/${l.service_id}`,"_blank","incognito=yes"):a.button!==2&&M.push({name:"Service Details",params:{id:l.service_id}})}const F=p({}),Ie=p(!1);function ut(t,l,a){l!=="delete"?a.ctrlKey||a.button===1||a==="openNewTab"?window.open(`implementation-type/requirement/${l.Requirement._id}`,"_blank"):a==="openNewWindow"?window.open(`implementation-type/requirement/${l.Requirement._id}`,"_blank","width=full,height=full"):a==="openIncognitoWindow"?window.open(`implementation-type/requirement/${l.Requirement._id}`,"_blank","incognito=yes"):a.button!==2&&M.push({name:"ImplementationRequirementDetails",params:{_id:l.Requirement._id}}):(console.log(t,l,a,"DELETE REQUIREMENT (goToRequirement)"),F.value=t,Ie.value=!0)}function dt(t,l,a){l==="delete"?(o.selectedComponentID=t._id,Qt()):a.ctrlKey||a.button===1||a==="openNewTab"?window.open(`implementation-type/guideline/service_bundle/${l.service_bundle_id}`,"_blank"):a==="openNewWindow"?window.open(`implementation-type/guideline/service_bundle/${l.service_bundle_id}`,"_blank","width=full,height=full"):a==="openIncognitoWindow"?window.open(`implementation-type/guideline/service_bundle/${l.service_bundle_id}`,"_blank","incognito=yes"):a.button!==2&&M.push({name:"Guideline Service Bundle",params:{id:l.service_bundle_id}})}const mt=["Name","SkillTier","PerUnitPricingBasis","BillingUnitType","BillingFrequency","RecommendedBlockHours","Description","QualificationQuestion","IncludeByDefault","DocURL","isDraft","InternalNotes","IsDeprecated","IsDeprecatedReason"],ie=p("");function pt(t){o.showModal=!0,ie.value=t}const{mutate:ct,onDone:ft,onError:vt}=B(Ua,()=>({variables:{implementation_guideline_idNew:v.params.id,product_id:o.selectedComponentID,quantity:o.quantity,IsOptional:o.isOptional}}));ft(t=>{const l=t.data.CreateImplementationGuidelineProductMutation;I.value.push({...l.Product,_id:l._id,Quantity:l.quantity,IsOptional:l.IsOptional,product_id:l.product_id}),u.notify({message:"Product Attached: "+l.Product.name,color:"green",icon:"done",timeout:4e3})}),vt(t=>{console.log("onErrorCreateImplementationGuidelineProduct",t)});const{mutate:ht,onDone:kt}=B(La,()=>({variables:{_id:o.selectedComponentID,quantity:o.quantity,IsOptional:o.isOptional}}));kt(t=>{I.value.map(l=>{l._id===t.data.UpdateImplementationGuidelineProductMutation._id&&(l.quantity=t.data.UpdateImplementationGuidelineProductMutation.quantity,l.IsOptional=t.data.UpdateImplementationGuidelineProductMutation.IsOptional)}),u.notify({message:"Product Updated: "+t.data.UpdateImplementationGuidelineProductMutation.Product.name,color:"green",icon:"done",timeout:3e3})});const{mutate:gt,onDone:yt}=B(ja,()=>({variables:{_id:o.selectedComponentID,Quantity:o.quantity,IsOptional:o.isOptional}}));yt(t=>{s.value.map(l=>{l._id===t.data.UpdateImplementationGuidelineServiceMutation._id&&(l.Quantity=t.data.UpdateImplementationGuidelineServiceMutation.Quantity,l.IsOptional=t.data.UpdateImplementationGuidelineServiceMutation.IsOptional)}),u.notify({message:"Service Updated: "+t.data.UpdateImplementationGuidelineServiceMutation.Service.name,color:"green",icon:"done",timeout:3e3})});const{mutate:Tt,onDone:St}=B(Fa,()=>({variables:{_id:o.selectedComponentID,Quantity:o.quantity,IsOptional:o.isOptional}}));St(t=>{k.value.map(l=>{l._id===t.data.UpdateImplementationGuidelineServiceBundleMutation._id&&(l.Quantity=t.data.UpdateImplementationGuidelineServiceBundleMutation.Quantity,l.IsOptional=t.data.UpdateImplementationGuidelineServiceBundleMutation.IsOptional)}),u.notify({message:"Service Bundle Updated: "+t.data.UpdateImplementationGuidelineServiceBundleMutation.ServiceBundle.name,color:"green",icon:"done",timeout:3e3})});const{mutate:It,onDone:wt,onError:Ct}=B(Ha,()=>({variables:{_id:o.selectedComponentID}}));wt(t=>{console.log(t,I.value,"onDoneDeleteImplementationGuidelineProduct"),I.value.splice(I.value.findIndex(l=>l._id===t.data.DeleteImplementationGuidelineProductMutation._id),1),u.notify({message:"Product Detached: "+t.data.DeleteImplementationGuidelineProductMutation.Product.name,color:"primary",icon:"delete",timeout:4e3})}),Ct(t=>{console.log("onErrorDeleteImplementationGuidelineProduct",t)});const{mutate:bt,onDone:Dt,onError:Rt}=B(Wa,()=>({variables:{implementation_guideline_idNew:v.params.id,service_id:o.selectedComponentID,Quantity:o.quantity,IsOptional:o.isOptional}}));Dt(t=>{const l=t.data.CreateImplementationGuidelineServiceMutation;s.value.push({...l.Service,_id:l._id,Quantity:l.Quantity,IsOptional:l.IsOptional,service_id:l.service_id}),u.notify({message:"Service Attached: "+l.Service.name,color:"green",icon:"done",timeout:4e3})}),Rt(t=>{console.log("onErrorCreateImplementationGuidelineService",t)});const{mutate:Mt,onDone:Nt,onError:Pt}=B(za,()=>({variables:{_id:o.selectedComponentID}}));Nt(t=>{s.value.splice(s.value.findIndex(l=>l._id===t.data.DeleteImplementationGuidelineServiceMutation._id),1),u.notify({message:"Service Detached: "+t.data.DeleteImplementationGuidelineServiceMutation.Service.name,color:"primary",icon:"delete",timeout:4e3})}),Pt(t=>{console.log("onErrorDeleteImplementationGuidelineService",t)});const{mutate:_t,onDone:qt,onError:Gt}=B(Ka,()=>({variables:{implementation_guideline_idNew:v.params.id,service_bundle_id:o.selectedComponentID,Quantity:o.quantity,IsOptional:o.isOptional}}));qt(t=>{const l=t.data.CreateImplementationGuidelineServiceBundleMutation;k.value.push({...l.ServiceBundle,_id:l._id,Quantity:l.Quantity,IsOptional:l.IsOptional,service_bundle_id:l.service_bundle_id}),u.notify({message:"Service Bundle Attached: "+l.ServiceBundle.name,color:"green",icon:"done",timeout:4e3})}),Gt(t=>{console.log("onErrorCreateImplementationGuidelineServiceBundle",t)});const{mutate:Bt,onDone:$t,onError:Ot}=B(Za,()=>({variables:{implementation_task_id:o.selectedImplementationTask._id,requirement_id:o.selectedComponentID}}));$t(t=>{console.log(t,"onDoneAttachRequirementToTask"),O.value.push({...o.selectedComponentItem,RequirementName:o.selectedComponentItem.Name,Name:o.selectedComponentItem.Name,Description:o.selectedComponentItem.Description,RelatedImplementationTask:o.selectedImplementationTask}),console.log(i.value,"guidelinePhaseTasks VALUE"),console.log(q.value,"guidelineTaskRequirements VALUE"),u.notify({message:"Attached Requirement: "+t.data.CreateImplementationTaskRequirement.Requirement.Name,color:"green",icon:"done",timeout:4e3,actions:[{label:"Refresh Page",color:"white",handler:()=>{window.location.reload()}}]})}),Ot(t=>{console.log("onErrorAttachRequirementToTask",t)});const{mutate:Qt,onDone:At,onError:Et}=B(Ya,()=>({variables:{_id:o.selectedComponentID}}));At(t=>{console.log("onDoneDeleteImplementationGuidelineServiceBundle",t),k.value.splice(k.value.findIndex(l=>l._id===t.data.DeleteImplementationGuidelineServiceBundleMutation._id),1),u.notify({message:"Service Bundle Detached: "+t.data.DeleteImplementationGuidelineServiceBundleMutation.ServiceBundle.name.Name,color:"primary",icon:"delete",timeout:4e3})}),Et(t=>{console.log("onErrorDeleteImplementationGuidelineServiceBundle",t)});function Vt(){ie.value==="Product"?ct():ie.value==="Service"?bt():ie.value==="Service Bundle"?_t():ie.value==="Requirement"&&(o.selectedImplementationTask&&o.selectedImplementationTask._id!==null&&o.selectedImplementationTask._id!==void 0||(o.selectedImplementationTask=g.value[0]),Bt()),setTimeout(()=>{o.quantity=1,o.isOptional=!1},2e3)}function Ut(t,l){console.log(t,"updateAttachedComponent"),typeof l=="boolean"?o.isOptional=l:typeof l=="number"?o.quantity=l:(o.quantity=t.Quantity,o.isOptional=t.IsOptional),o.selectedComponentID=t._id,t.__typename==="Product"?ht():t.__typename==="Service"?gt():t.__typename==="ServiceBundle"&&Tt()}function Lt(t,l){console.log(t,l,"setComponentValue"),l==="item"&&(o.selectedComponentID=t.id??t._id??t.autotask_id,o.selectedComponentItem=t)}function jt(t){o.showModal=t}function Ft(t){console.log("pushCreatedTask",t,i.value),i.value.some(l=>l.ProjectProcessName===t.ProjectProcess.Name)||i.value.push({...t.ProjectProcess,relatedItems:t}),i.value.map(l=>{l.ProjectProcessName===t.ProjectProcess?.Name&&(l.relatedItems.push(t),l.ImplementationTasks.push(t))})}function Ht(t,l){console.log(t,l,"data pushed for SKILLS"),Q.value=!1,l==="delete"?b.value.splice(b.value.findIndex(a=>a.autotask_id===t.autotask_id),1):b.value.push(t)}function Wt(){Q.value=!1,console.log("refetchSkillData DAN")}function zt(t){b.value.push({...t,skill_id:t.autotask_id})}const ee=Ca(),{result:we,loading:Kt}=H(Ja,()=>({first:30,Name:ee.search,page:ee.page})),fe=p(!1),X=p([]),Be=p(null);Z(()=>{if(Kt.value&&(fe.value=!0),Be.value!==ee.search&&(fe.value=!0,X.value=[],Be.value=ee.search),we.value){console.log(we.value,"implementationTypesData"),fe.value=!1;const t=X.value,l=we.value.ImplementationTypes.data.filter(a=>!X.value.some(h=>h._id===a._id));ee.page>1?X.value=[...X.value,...l]:X.value=[...l,...X.value],ee.setSpinner(X.value,t)}});const Ce=p(!1);function Yt(t){Te.value={_id:v.params.id,ImplementationType_id:t._id},_e(),o.implementationTypeName=t.Name,setTimeout(()=>{Ce.value=!0},200),setTimeout(()=>{Ce.value=!1},500)}ke(()=>{ne(),ee.onSetValueCallback(Yt)});function Jt(t){o.showComponentType=t}function Xt(t){return t===o.showComponentType?"blue-6":"primary"}let Zt=p([{type:"all",label:"All Relations",icon:"sort"},{type:"skill",label:"Skills",icon:"info"},{type:"task",label:"Tasks",icon:"history"},{type:"requirement",label:"Requirements",icon:"history"},{type:"product",label:"Products",icon:"layers"},{type:"service",label:"Services",icon:"description"},{type:"serviceBundle",label:"Service Bundles",icon:"build"}]);function xt(t){let l="cursor-pointer",a=null,h="",N=0;return t.type==="skill"?(a=b.value,N=b.value.length):t.type==="task"?(a=i.value,N=i.value.length):t.type==="product"?(a=I.value,N=I.value.length):t.type==="service"?(a=s.value,N=s.value.length):t.type==="serviceBundle"?(a=k.value,N=k.value.length):t.type==="all"?(a=I.value,N=I.value.concat(s.value).concat(k.value).concat(b.value).concat(i.value).length):t.type==="requirement"&&(a=O.value,N=O.value.filter(be=>be.Requirement!==null).length),t.type,o.showComponentType,h="white",{cursor:l,textColor:h,tooltip:a,icon:t.icon,count:N}}const ea=[{type:"phase",label:"Show Phases & Tasks",icon:"sort"},{type:"all",label:"Show All Relations",icon:"info"},{type:"requirements",label:"Show Tasks & Requirements",icon:"bolt"}],ta=V(()=>o.showTasksTable==!0?q.value:i.value.filter(t=>t.Name.toLowerCase().includes(o.searchTask.toLowerCase())));function aa(t){console.log(t,"setShowTasksTable"),o.showTasksTable=t,t===!0&&i.value}const na=le([{name:"name",align:"left",label:"Name",field:t=>t.Name,format:t=>`${t}`},{name:"description",align:"left",label:"Description",field:t=>t.Description?t.Description:"N/A",format:t=>`${t}`},{name:"relatedTask",align:"left",label:"Related Implementation Task",field:t=>t.RelatedImplementationTask.Name,format:t=>`${t}`},{name:"attachment",align:"right",label:"Actions"}]),{mutate:$e,onDone:oa}=B(ga,()=>({variables:{_id:F.value.RelatedImplementationTask._id,_ids:F.value.requirement_id}}));oa(t=>{console.log(t,F.value,"onDoneDetachedReq"),u.notify({message:"Requirement Detached: "+F.value.Requirement.Name,color:"primary",icon:"delete",timeout:4e3,actions:[{label:"Refresh Page",color:"white",handler:()=>{window.location.reload()}}]}),O.value.splice(O.value.findIndex(l=>l.requirement_id===F.value.requirement_id),1),i.value=i.value.map(l=>({...l,relatedItems:l.relatedItems.map(a=>({...a,ImplementationTaskRequirements:a.ImplementationTaskRequirements.filter(h=>h._id===F.value._id)}))})),console.log(i.value,"guidelinePhaseTasks VALUE"),q.value=q.value.map(l=>({...l,relatedItems:l.relatedItems.filter(a=>a.requirement_id!==F.value.requirement_id)}))});function Oe(t){Ie.value=t}function la(){Oe(!1),$e()}return{state:o,route:v,guidelineSkills:b,setShowSkillModal:K,setPage:ot,guideline:j,products:I,services:s,guidelinePhaseTasks:i,setShowTaskModal:d,goToTaskDetails:it,columns:Y,editingTask:ae,guidelineData:L,recurringColumns:J,goToProduct:st,goToService:rt,taskRouteID:n,serviceBundles:k,goToServiceBundle:dt,editableFields:mt,updateImplementationGuideline:nt,introspectionValue:ye,componentType:ie,attachComponent:pt,setShowModal:jt,saveAttachedComponent:Vt,setComponentValue:Lt,pushCreatedTask:Ft,updateAttachedComponent:Ut,pushNewSkillData:Ht,refetchSkillData:Wt,addSkillToGuideline:zt,darkmode:_,implementationTypes:X,isLoadingImplementationTypes:fe,searchOptions:ee,cancelEditing:Ce,setSection:Jt,activeColor:Xt,sowToggleOptions:Zt,sowToggle:xt,loading:x,headerToggleOptions:ea,requirements:O,setShowTasksTable:aa,computedGuidelinePhaseTasks:ta,guidelineTaskRequirements:q,requirementColumns:na,goToRequirement:ut,implementationTasks:g,showDeleteRequirementConfirmation:Ie,selectedRequirement:F,detachRequirement:la,setDeleteConfirmationModal:Oe}}}),Bn={class:"flex justify-center mx-3 mb-10 sm:mx-12 animate__animated animate__fadeIn",style:{width:"100%"}},$n={style:{width:"100%"}},On={key:0,class:"mb-8 text-center text-2xl dark:text-[#CBD5E1]"},Qn={class:"flex justify-center"},An={key:1,class:"w-full h-2 mt-10 dark:border-slate-500"},En={class:"items-center"},Vn={style:{"list-style":"disc"},class:"ml-4"},Un={key:2,class:"intro-y col-span-12 lg:overflow-visible mt-5 relative"},Ln={class:"table table-report mt-5"},jn={class:""},Fn={class:"mt-0 sm:mb-[-.5rem] text-lg dark:text-slate-300"},Hn={class:"italic text-slate-500 ml-2 text-sm"},Wn={class:"grid grid-cols-2 gap-4 mt-8"},zn={key:3,class:"w-full h-2 mt-5 dark:border-slate-500"},Kn={class:"flex justify-end mt-5 -mb-5 relative"},Yn={class:"flex justify-end"},Jn={class:"ml-4 mr-3 mt-5"},Xn={key:0},Zn={key:1},xn={key:5,class:"w-full h-2 mt-10 dark:border-slate-500"},eo={key:6,class:"flex justify-end mt-5 -mb-5 relative"},to={key:8,class:"w-full h-2 mt-10 dark:border-slate-500"},ao={key:9,class:"flex justify-end mt-5 -mb-5 relative"},no={key:11,class:"w-full h-2 mt-10 dark:border-slate-500"},oo={key:12,class:"flex justify-end mt-5 -mb-5 relative"};function lo(e,n,R,w,f,C){const T=U("SearchModel"),D=U("QCardDetails"),_=U("MiniCardContainer"),v=U("ListQTable"),M=U("AccordianQTableDeep"),o=U("SearchComponent"),u=U("BasicAttachModal"),ae=U("CreateGuidelineTaskModal"),x=U("DeleteConfirmationModal");return m(),P("div",Bn,[r("div",$n,[e.loading?y("",!0):(m(),P("p",On,E(e.guideline.Name),1)),r("div",Qn,[e.loading?(m(),G(ia,{key:0,class:"mb-8 h-3 w-80"})):y("",!0)]),c(D,{type:"ImplementationGuideline",response:e.guideline,editableFields:e.editableFields,updateResponse:e.updateImplementationGuideline,introspectionValue:e.introspectionValue,cancelEditing:e.cancelEditing,isLoading:e.loading},{slot3:S(()=>[c(T,{label:"Implementation Types",filled:"",dense:"","no-focus":"",rows:e.implementationTypes,loading:e.isLoadingImplementationTypes,store:e.searchOptions,defaultValue:e.guideline.ImplementationType,dark:e.darkmode},null,8,["rows","loading","store","defaultValue","dark"])]),_:1},8,["response","editableFields","updateResponse","introspectionValue","cancelEditing","isLoading"]),e.state.showQuasarComponent===""?(m(),P("hr",An)):y("",!0),r("div",En,[c(ua,{rounded:"",class:"px-0 mt-8 mb-5 mx-10 md:mx-0 w-full h-10"},{default:S(()=>[(m(!0),P(ve,null,he(e.sowToggleOptions,(d,z)=>(m(),G(A,{key:z,color:e.activeColor(d.type),dark:e.darkmode,label:d.label+" ("+e.sowToggle(d).count+")",class:W([e.sowToggle(d).cursor,"w-full text-no-wrap"]),style:{"font-weight":"600","letter-spacing":"0.4px"},"no-caps":"","text-color":e.sowToggle(d).textColor,onClick:K=>e.setSection(d.type)},{default:S(()=>[e.sowToggle(d).tooltip?.length>0&&d.type!=="all"?(m(),G(Ae,{key:0,style:{"font-size":"0.9rem","min-width":"10rem","max-width":"20rem"},class:"bg-white text-slate-700 border shadow-md"},{default:S(()=>[r("ul",Vn,[(m(!0),P(ve,null,he(e.sowToggle(d).tooltip,(K,L)=>(m(),P("li",{key:L},E(K.name??K.Name),1))),128))])]),_:2},1024)):y("",!0)]),_:2},1032,["color","dark","label","class","text-color","onClick"]))),128))]),_:1})]),e.state.showComponentType==="all"||e.state.showComponentType==="skill"?(m(),P("div",Un,[r("div",null,[r("div",Ln,[r("div",jn,[r("p",Fn,[n[12]||(n[12]=te(" Related Skills ",-1)),r("span",Hn,E(e.guidelineSkills.length===0?"(None Associated)":""),1)]),c(A,{class:"btn btn-primary absolute right-0 top-0",color:"primary","no-caps":"",icon:"add",label:"Attach Skill",onClick:n[0]||(n[0]=d=>e.setShowSkillModal(!0))})])]),r("div",Wn,[(m(!0),P(ve,null,he(e.guidelineSkills,d=>(m(),P("div",{key:d._id,class:"intro-x w-full"},[c(_,{item:d,pushNewSkillData:e.pushNewSkillData,refetchSkillData:e.refetchSkillData},null,8,["item","pushNewSkillData","refetchSkillData"])]))),128))])])])):y("",!0),e.state.showComponentType==="all"?(m(),P("hr",zn)):y("",!0),r("div",Kn,[e.state.showComponentType==="all"||e.state.showComponentType==="task"?(m(),G(re,{key:0,modelValue:e.state.searchTask,"onUpdate:modelValue":n[1]||(n[1]=d=>e.state.searchTask=d),filled:"",dense:"",placeholder:"Search Implementation Tasks",class:"w-1/3 absolute left-0",style:{"margin-right":"1rem"},dark:e.darkmode},{append:S(()=>[c(ue,{name:"search"})]),_:1},8,["modelValue","dark"])):y("",!0),r("div",Yn,[c(A,{label:"Attach Requirement to Task",color:"primary","no-caps":"",icon:"add",onClick:n[2]||(n[2]=d=>e.attachComponent("Requirement"))})]),c(A,{color:"primary","no-caps":"",icon:"add",class:"ml-5",label:"Attach Implementation Task",onClick:n[3]||(n[3]=d=>e.setShowTaskModal(!0))})]),r("div",{class:W(["flex",e.state.showComponentType==="task"?"flex-col-reverse":"flex-col"])},[e.state.showComponentType==="requirement"||e.state.showComponentType==="task"?(m(),G(v,{key:0,title:"Related Requirements",rows:e.requirements,columns:e.requirementColumns,handleRowClick:e.goToRequirement,stateValue:e.state,setPage:e.setPage,loading:e.state.searchLoading,headerTooltip:"These are Requirements that are associated with ImplementationTasks",customNoDataText:"Searching for Task Requirements...",showPagination:!1,updateComponent:e.updateAttachedComponent},null,8,["rows","columns","handleRowClick","stateValue","setPage","loading","updateComponent"])):y("",!0),e.guidelinePhaseTasks&&(e.state.showComponentType==="all"||e.state.showComponentType==="task"||e.state.showComponentType==="requirement")?(m(),G(M,{key:1,title:"Related Implementation Tasks & Requirements",rows:e.computedGuidelinePhaseTasks,columns:e.columns,stateValue:e.state,setPage:e.setPage,loading:e.state.searchLoading,handleRowClick:e.goToTaskDetails,showPagination:!1,rowName:"Name",filterByRowName:"Name",filterByRowNameSecondary:"Name",relatedHeaderTitle:e.state.showTasksTable===!0?"Requirements":"Tasks",relatedHeaderTitleSecondary:"Requirements",redirectToTask:e.state.showTasksTable===!0?"/implementation-type/requirement/":"/implementation-type/task/",expansionHeaderName:"Related "+(e.state.showTasksTable===!0?"Task":"Phase"),byPassExpansionConditionals:"","show-delete-option":"","show-header-toggle":"",headerToggleOptions:e.headerToggleOptions,topLeftTooltip:e.requirements,setShowTasksTable:e.setShowTasksTable,showDeepestDeleteOption:!0,dense:""},null,8,["rows","columns","stateValue","setPage","loading","handleRowClick","relatedHeaderTitle","redirectToTask","expansionHeaderName","headerToggleOptions","topLeftTooltip","setShowTasksTable"])):y("",!0)],2),e.state.showModal?(m(),G(u,{key:4,showComponentModal:e.state.showModal,setComponentModal:e.setShowModal,createOnly:!0,title:e.componentType,saveComponent:e.saveAttachedComponent,selectedComponentID:e.state.selectedComponentID,width:"30rem",createNewHref:e.componentType==="Requirement"?"/requirement/create/":null},{default:S(()=>[r("div",Jn,[e.componentType==="Requirement"?(m(),P("div",Xn,[n[13]||(n[13]=te(" Select a Implementation Task to attach this Requirement ",-1)),e.implementationTasks.length>0?(m(),G(da,{key:0,label:"Related Task: "+(e.state.selectedImplementationTask!==null?e.state.selectedImplementationTask.Name:e.implementationTasks[0].Name),color:"primary",class:"my-3","no-caps":"",dark:e.darkmode},{default:S(()=>[c(Ue,{dark:e.darkmode,class:W(e.darkmode?"bg-[#354161]":"bg-white")},{default:S(()=>[(m(!0),P(ve,null,he(e.implementationTasks,d=>ma((m(),G(De,{key:d._id,dark:e.darkmode,clickable:"",onClick:z=>e.state.selectedImplementationTask=d},{default:S(()=>[c(Ee,null,{default:S(()=>[c(ca,null,{default:S(()=>[te(E(d.Name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["dark","onClick"])),[[fa]])),128))]),_:1},8,["dark","class"])]),_:1},8,["label","dark"])):y("",!0),n[14]||(n[14]=r("hr",{class:"border-slate-500 mt-2 mb-5"},null,-1))])):y("",!0),c(o,{type:e.componentType,setValue:e.setComponentValue,filled:"","no-focus":"",class:"mb-4"},null,8,["type","setValue"]),e.componentType!=="Requirement"?(m(),P("div",Zn,[c(re,{modelValue:e.state.quantity,"onUpdate:modelValue":n[4]||(n[4]=d=>e.state.quantity=d),modelModifiers:{number:!0},type:"number",filled:"",label:"Quantity",dark:e.darkmode,class:W(e.darkmode?"bg-[#202a46]":"")},null,8,["modelValue","dark","class"]),c(va,{modelValue:e.state.isOptional,"onUpdate:modelValue":n[5]||(n[5]=d=>e.state.isOptional=d),label:"Is Optional"},null,8,["modelValue"])])):y("",!0)])]),_:1},8,["showComponentModal","setComponentModal","title","saveComponent","selectedComponentID","createNewHref"])):y("",!0),e.state.showComponentType==="all"?(m(),P("hr",xn)):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="product"?(m(),P("div",eo,[c(re,{modelValue:e.state.searchProduct,"onUpdate:modelValue":n[6]||(n[6]=d=>e.state.searchProduct=d),filled:"",dense:"",placeholder:"Search Products",class:"w-40 sm:w-60 absolute left-0",style:{"margin-right":"1rem"},dark:e.darkmode},{append:S(()=>[c(ue,{name:"search"})]),_:1},8,["modelValue","dark"]),c(A,{color:"primary","no-caps":"",icon:"add",label:"Attach Product",onClick:n[7]||(n[7]=d=>e.attachComponent("Product"))})])):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="product"?(m(),G(v,{key:7,title:"Related Products",rows:e.products.filter(d=>d.name.toLowerCase().includes(e.state.searchProduct.toLowerCase())),columns:e.recurringColumns,handleRowClick:e.goToProduct,stateValue:e.state,setPage:e.setPage,loading:e.state.searchLoading,customNoDataText:"Searching for Products...",showPagination:!1,updateComponent:e.updateAttachedComponent},null,8,["rows","columns","handleRowClick","stateValue","setPage","loading","updateComponent"])):y("",!0),e.state.showComponentType==="all"?(m(),P("hr",to)):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="service"?(m(),P("div",ao,[c(A,{color:"primary","no-caps":"",icon:"add",label:"Attach Service",onClick:n[8]||(n[8]=d=>e.attachComponent("Service"))}),c(re,{modelValue:e.state.searchService,"onUpdate:modelValue":n[9]||(n[9]=d=>e.state.searchService=d),filled:"",dense:"",placeholder:"Search Services",class:"w-40 sm:w-60 absolute left-0",style:{"margin-right":"1rem"},dark:e.darkmode},{append:S(()=>[c(ue,{name:"search"})]),_:1},8,["modelValue","dark"])])):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="service"?(m(),G(v,{key:10,title:"Related Services",rows:e.services.filter(d=>d.name.toLowerCase().includes(e.state.searchService.toLowerCase())),columns:e.recurringColumns,handleRowClick:e.goToService,stateValue:e.state,setPage:e.setPage,loading:e.state.searchLoading,customNoDataText:"Searching for Services...",showPagination:!1,updateComponent:e.updateAttachedComponent},null,8,["rows","columns","handleRowClick","stateValue","setPage","loading","updateComponent"])):y("",!0),e.state.showComponentType==="all"?(m(),P("hr",no)):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="serviceBundle"?(m(),P("div",oo,[c(A,{color:"primary","no-caps":"",icon:"add",label:"Attach Service Bundle",onClick:n[10]||(n[10]=d=>e.attachComponent("Service Bundle"))}),c(re,{modelValue:e.state.searchServiceBundle,"onUpdate:modelValue":n[11]||(n[11]=d=>e.state.searchServiceBundle=d),filled:"",dense:"",placeholder:"Search Service Bundles",class:"w-[9.5rem] sm:w-60 absolute left-0",style:{"margin-right":"1rem"},dark:e.darkmode},{append:S(()=>[c(ue,{name:"search"})]),_:1},8,["modelValue","dark"])])):y("",!0),e.state.showComponentType==="all"||e.state.showComponentType==="serviceBundle"?(m(),G(v,{key:13,title:"Related Service Bundles",rows:e.serviceBundles.filter(d=>d.name.toLowerCase().includes(e.state.searchServiceBundle.toLowerCase())),columns:e.recurringColumns,handleRowClick:e.goToServiceBundle,stateValue:e.state,setPage:e.setPage,loading:e.state.searchLoading,customNoDataText:"Searching for Service Bundles...",showPagination:!1,updateComponent:e.updateAttachedComponent},null,8,["rows","columns","handleRowClick","stateValue","setPage","loading","updateComponent"])):y("",!0)]),e.guideline?(m(),G(ae,{key:0,route:e.route,setShowModal:e.setShowTaskModal,showModal:e.state.showTaskModal,guideline:e.guideline,pushCreatedTask:e.pushCreatedTask},null,8,["route","setShowModal","showModal","guideline","pushCreatedTask"])):y("",!0),e.showDeleteRequirementConfirmation?(m(),G(x,{key:1,detachedComponent:e.selectedRequirement.Name,parentComponent:e.selectedRequirement.RelatedImplementationTask.Name,message:"You will detach this Requirement: ",message2:"From ImplementationTask:",deleteComponent:e.detachRequirement,setComponentModal:e.setDeleteConfirmationModal},null,8,["detachedComponent","parentComponent","deleteComponent","setComponentModal"])):y("",!0)])}const el=de(Gn,[["render",lo]]);export{el as default};
