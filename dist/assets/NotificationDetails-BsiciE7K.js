import{a6 as F,a7 as G,al as J,am as f,a9 as d,a8 as b,ab as k,aa as h,ac as a,af as i,ag as u,ah as p,ao as I,Q as w,ae as K,au as T,aj as W,ak as X,E as Y,T as v,U as Z,aB as M,ax as P,ay as Q,a3 as x}from"./index-BmmqEUwr.js";import{Q as $}from"./QCardSection-W7OKuTbN.js";import{Q as m}from"./QToggle-CHdCZyvb.js";import{Q as _,u as tt}from"./dark-mode-CG8Py2TO.js";import{Q as et}from"./QCard-71HNS0Eo.js";import{u as it}from"./use-quasar-jxPryvnm.js";import{a as ot}from"./AccountNotification-DI806uDI.js";import{U as st,D as at}from"./AccountNotification-CMHT11QZ.js";import{S as lt}from"./SiemNotification-D11pfE7m.js";import{S as nt}from"./SearchModel-B_5zHey7.js";import{e as rt}from"./searchStore-B6YwqjjR.js";import"./use-key-composition-DGnxYdx2.js";import"./index-DO6kqxPy.js";import"./parser-4S4bR1x6.js";import"./QResizeObserver-Dl2MazeZ.js";import"./QScrollObserver-CK8Scf4k.js";import"./touch-BjYP5sR0.js";import"./ClosePopup-Dl7x5pRy.js";import"./search-pI3uLz3p.js";const dt=G({name:"NotificationDetails",components:{SearchModel:nt},setup(){const t=T({totalPages:10,high:!1,medium:!1,low:!1,critical:!1,info:!1,email:!1,sms:!1,severityArray:[],siemNotificationTypeName:"",siemNotificationTypeID:"",accountID:null,notificationTypeID:null,description:"",isEditingNotification:!1,isEditingDescription:!1}),e=W(),S=X(),C=Y(()=>tt().darkmode),l=v([]);Z(()=>t.isSIEM,()=>{t.isSIEM?(t.notificationTypes=["SIEM"],y("notificationType")):(t.notificationTypes=[],y("notificationType"))});const{result:c,loading:N,error:o}=M(ot,()=>({_id:e.params.id})),U=T([{name:"Contact Preferences",description:"How shall Project Central notify you on important updates"},{name:"Notification Priority",description:"Set the priority of notifications that this user will receive"},{name:"Remove Notification Account",description:"This will remove the Notification Preferences for this user"}]);P(()=>{c.value&&c.value.AccountNotification&&(l.value=c.value.AccountNotification,l.value.severity&&l.value.severity.forEach(s=>{s===0&&(t.critical=!0),s===1&&(t.high=!0),s===2&&(t.medium=!0),s===3&&(t.low=!0),s===4&&(t.info=!0)}),l.value.NotificationTypes.includes("SIEM")&&(t.notificationTypes=["SIEM"]),t.accountID=l.value.account_id,t.siemNotificationTypeName=l.value.SIEMNotificationName,t.description=l.value.description,l.value.severity&&(t.severityArray=l.value.severity),t.email=c.value.AccountNotification.send_email,t.sms=c.value.AccountNotification.send_sms)});const{mutate:B,onDone:L}=Q(st,()=>({variables:{_id:e.params.id,send_email:t.email,send_sms:t.sms,severity:t.severityArray,siem_notification_id:t.notificationTypeID}})),V=it();L(s=>{console.log(s,"RESULT"),V.notify({message:"Account Notification Preferences were adjusted",color:"green-5",icon:"check"})});function y(s){s!=="email"&&s!=="sms"&&s!=="notificationType"&&s!=="description"&&(t.severityArray.length>0&&t.severityArray.includes(s)?t.severityArray=t.severityArray.filter(A=>A!==s):t.severityArray=[...t.severityArray,s]),B()}const{mutate:R,onDone:j}=Q(at,()=>({variables:{_id:e.params.id}}));j(()=>{V.notify({message:"Account Notification Deleted",color:"red-5",icon:"check"}),S.push({path:"/notifications"})});const z=v([{label:"---",value:"---"},{label:"SIEM",value:"SIEM"}]),n=rt(),{result:D}=M(lt,()=>({title:n.search,first:15,page:n.page})),g=v(!1),E=v(""),r=v([]);P(()=>{if(N.value&&(g.value=!0),E.value!==n.search&&(console.log(n,"searchOptionsBase.search"),g.value=!0,r.value=[],E.value=n.search),D.value){g.value=!1;const s=r.value,A=D.value.SiemNotifications.data.filter(O=>!r.value.some(q=>q.title===O.title));n.page>1?r.value=[...r.value,...A]:r.value=[...A,...r.value],n.setSpinner(r.value,s)}});function H(s){t.notificationTypeID=s.id,console.log(t.notificationTypeID,"setSIEMNotifcationID"),y("notificationType")}return x(()=>{n.onSetValueCallback(H)}),{state:t,notifications:U,accountNotifications:c,loading:N,error:o,userNotifications:l,updateAccountNotification:y,deleteAccountNotification:R,options:z,darkmode:C,siemNotifications:r,isLoading:g,searchOptionsBase:n}},data(){return{notify:!1}}}),ct={class:"w-full"},ut={class:"pt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3"},mt={class:"col-span-1 md:col-span-2"},ft={class:"text-lg"},pt={class:"text-slate-700"},vt={class:"mt-1 flex flex-col items-start mt-4 sm:mt-0 sm:items-end pr-5"},Nt={class:"text-slate-500"},yt={class:"text-slate-700 dark:text-slate-300"},gt={class:"text-slate-500"},At={class:"text-slate-700 dark:text-slate-300"},kt={class:"relative"},bt={class:"text-lg bold mt-3"},ht={key:0,class:"flex absolute right-0 top-0"},St={class:"text-slate-500 mt-2"},Ct={class:"mb-3 pt-3 border-t"},Vt={class:"flex"},Dt={class:"flex ml-10"},Et={class:"grid grid-cols-2"},It={class:""},wt={key:0,class:"text-slate-500 mt-2"},Tt={class:""},Mt={class:"grid grid-cols-2"},Pt={class:""},Qt={key:0,class:"text-slate-500 mt-2"},$t={class:"flex flex-col"},Ut={class:"flex relative"},Bt={class:"grid grid-cols-2 gap-1 ml-10"},Lt={class:"flex flex-col"},Rt={class:"flex flex-col"},jt={class:"flex"};function zt(t,e,S,C,l,c){const N=J("SearchModel");return d(),f("div",ct,[t.accountNotifications?(d(),b(et,{key:0,class:K(["animate__fadeIn mx-10",t.darkmode?"bg-[#28334E] text-slate-300":"bg-white border"]),style:{"animation-duration":"0.5s"}},{default:h(()=>[a($,null,{default:h(()=>[i("div",ut,[i("div",mt,[i("p",ft,u(t.userNotifications.ContactName),1),i("p",pt,u(t.userNotifications.ContactEmail),1)]),i("div",vt,[i("p",Nt,[e[18]||(e[18]=p(" Account Name: ",-1)),i("span",yt,u(t.userNotifications.AccountName??"N/A"),1)]),i("p",gt,[e[19]||(e[19]=p(" Primary Phone: ",-1)),i("span",At,u(t.userNotifications.ContactPrimaryPhone&&t.userNotifications.ContactPrimaryPhone!==""?t.userNotifications.ContactPrimaryPhone:"N/A"),1)])])]),e[21]||(e[21]=i("hr",{class:"my-4"},null,-1)),i("div",kt,[i("p",bt,[e[20]||(e[20]=p("Account Notification Preferences ",-1)),a(I,{label:"Priority Levels...",color:"primary",flat:"",dense:"",href:"https://www.aislabs.com/getting-started/service-level-objective/",target:"_blank",class:"py-0 absolute right-5 top-16 sm:top-12 mt-2 md:top-0","no-caps":""})]),t.accountNotifications?(d(),f("div",ht)):k("",!0),i("p",St," Set "+u(t.userNotifications.ContactName)+"'s preferences for important notifications about their account ",1)])]),_:1}),a($,null,{default:h(()=>[i("div",Ct,[i("div",Vt,[e[22]||(e[22]=i("div",{class:""},[i("p",{class:"text-semisbold"},"Contact Preferences"),i("p",{class:"text-slate-500 mt-2"}," How shall Project Central notify this user on important updates ")],-1)),i("div",Dt,[a(m,{modelValue:t.state.email,"onUpdate:modelValue":e[0]||(e[0]=o=>t.state.email=o),label:"Email",class:"mr-10 ml-10",onClick:e[1]||(e[1]=o=>t.updateAccountNotification("email"))},null,8,["modelValue"]),a(m,{modelValue:t.state.sms,"onUpdate:modelValue":e[2]||(e[2]=o=>t.state.sms=o),label:"SMS",onClick:e[3]||(e[3]=o=>t.updateAccountNotification("sms"))},null,8,["modelValue"])])]),e[27]||(e[27]=i("hr",{class:"my-5"},null,-1)),i("div",Et,[i("div",It,[e[23]||(e[23]=i("p",{class:"text-semisbold"},"Available Notifications",-1)),t.state.isEditingNotification?(d(),f("p",wt," Select the notification this user will receive ")):k("",!0)]),i("div",Tt,[t.state.isEditingNotification?(d(),b(N,{key:0,label:"SIEM Notifications",rows:t.siemNotifications,loading:t.isLoading,darkmode:t.darkmode,defaultValue:t.state.siemNotificationTypeName,value:"title",dense:"",filled:"",class:"-ml-10 mr-5","no-focus":"",store:t.searchOptionsBase},null,8,["rows","loading","darkmode","defaultValue","store"])):(d(),f("p",{key:1,class:"cursor-pointer",onClick:e[4]||(e[4]=o=>t.state.isEditingNotification=!0)},[a(w,{name:"edit",size:"xs",class:"mr-3 -ml-10 text-slate-400"}),p(u(t.state.siemNotificationTypeName??"N / A"),1)]))])]),e[28]||(e[28]=i("hr",{class:"my-5"},null,-1)),i("div",Mt,[i("div",Pt,[e[24]||(e[24]=i("p",{class:"text-semisbold"},"Notification Description",-1)),t.state.isEditingDescription?(d(),f("p",Qt," Add a description to this account notification ")):k("",!0)]),i("div",$t,[t.state.isEditingDescription?(d(),b(_,{key:0,modelValue:t.state.description,"onUpdate:modelValue":e[5]||(e[5]=o=>t.state.description=o),label:"Description / Notes",filled:"","emit-value":"","map-options":"",class:"mt-0 -ml-10 mr-5 text-slate-300",dense:"",dark:t.darkmode,type:"textarea",onChange:e[6]||(e[6]=o=>t.updateAccountNotification("description"))},null,8,["modelValue","dark"])):(d(),f("p",{key:1,class:"cursor-pointer -ml-10 mr-5",onClick:e[7]||(e[7]=o=>t.state.isEditingDescription=!0)},[a(w,{name:"edit",size:"xs",class:"mr-3 text-slate-400"}),p(u(t.state.description??"N / A"),1)]))])]),e[29]||(e[29]=i("hr",{class:"my-5"},null,-1)),i("div",Ut,[e[25]||(e[25]=i("div",{class:""},[i("p",{class:"text-semisbold"},"Notification Priority"),i("p",{class:"text-slate-500 mt-2"}," Set the priority of notifications that this user will receive ")],-1)),i("div",Bt,[i("div",Lt,[a(m,{modelValue:t.state.high,"onUpdate:modelValue":e[8]||(e[8]=o=>t.state.high=o),label:"High",onClick:e[9]||(e[9]=o=>t.updateAccountNotification(1))},null,8,["modelValue"]),a(m,{modelValue:t.state.medium,"onUpdate:modelValue":e[10]||(e[10]=o=>t.state.medium=o),label:"Medium",onClick:e[11]||(e[11]=o=>t.updateAccountNotification(2))},null,8,["modelValue"]),a(m,{modelValue:t.state.low,"onUpdate:modelValue":e[12]||(e[12]=o=>t.state.low=o),label:"Low",onClick:e[13]||(e[13]=o=>t.updateAccountNotification(3))},null,8,["modelValue"])]),i("div",Rt,[a(m,{modelValue:t.state.critical,"onUpdate:modelValue":e[14]||(e[14]=o=>t.state.critical=o),label:"Critical",onClick:e[15]||(e[15]=o=>t.updateAccountNotification(0))},null,8,["modelValue"]),a(m,{modelValue:t.state.info,"onUpdate:modelValue":e[16]||(e[16]=o=>t.state.info=o),label:"Information",onClick:e[17]||(e[17]=o=>t.updateAccountNotification(4))},null,8,["modelValue"])])])]),e[30]||(e[30]=i("hr",{class:"my-5"},null,-1)),i("div",jt,[e[26]||(e[26]=i("div",{class:""},[i("p",{class:"text-semisbold"},"Remove Notification Account"),i("p",{class:"text-slate-500 mt-2"}," This will remove the Notification Preferences for this user ")],-1)),i("div",null,[a(I,{class:"ml-14 w-60 mt-5",style:{border:"1px solid rgb(235, 102, 102)"},"no-caps":"",dense:"",flat:"",color:"red",label:"Remove Notification Account",onClick:t.deleteAccountNotification},null,8,["onClick"])])])])]),_:1})]),_:1},8,["class"])):k("",!0)])}const le=F(dt,[["render",zt]]);export{le as default};
