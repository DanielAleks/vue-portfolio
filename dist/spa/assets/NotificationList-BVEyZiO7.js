import{a6 as $,a7 as B,al as S,am as R,a9 as V,af as A,ac as p,ao as D,au as L,T as s,O as b,U as I,aB as M,ax as _}from"./index-pp-zxjmJ.js";import{L as E}from"./ListQTable-0eXUoj3b.js";import{S as O}from"./SearchModel-Bs5n-Zcw.js";import{A as W}from"./AccountNotification-CmxW8kVs.js";import{A as j}from"./Account-BjVzKmM3.js";import{s as i}from"./search-DiX5JiHP.js";import"./QSelect-wdHiNoA7.js";import"./use-key-composition-CnPM_xP4.js";import"./QChip-C6yMxZyV.js";import"./QItemLabel-DjguDHTb.js";import"./QDialog-Fsjl9-tV.js";import"./QToggle-CCqmYG-z.js";import"./dark-mode-T9Pt6Rb6.js";import"./index-Cy3PLz-a.js";import"./parser-D6bCODxJ.js";import"./QMarkupTable-CXcSwnxR.js";import"./ClosePopup-Bou3snqx.js";import"./QPagination-DMGZXcC_.js";import"./QCard-B8NG_d02.js";import"./QSkeleton-Df1Ie8vx.js";import"./QSeparator-BsnedQuX.js";import"./QResizeObserver-B57LBLtT.js";import"./QScrollObserver-D-e6ZeCm.js";import"./touch-BjYP5sR0.js";const q=B({name:"ImplementationTypes",components:{ListQTable:E,SearchModel:O},setup(){const t=L({totalPages:10,page:1,searchLoading:!1,search:"",showComponentModal:!1,selectedAccountId:null}),g=s({currentPage:1,perPage:15});function r(e){if(e)return e.includes(0)?"Critical":e.includes(1)?"High":e.includes(2)?"Medium":e.includes(3)?"Low":e.includes(4)?"Information":"N/A"}const o=L([{name:"name",label:"Contact Name",align:"left",field:e=>e.ContactName,format:e=>`${e}`},{name:"notification",label:"Notification",align:"left",field:e=>e.SIEMNotificationName??"N/A"},{name:"priorityLevels",label:"Status",align:"center",field:e=>r(e.severity),sortable:!0},{name:"actions",label:"Actions",align:"center"}]),l=b("windowWidth"),h=()=>{if(l.value<=600){const e=o.findIndex(a=>a.name==="priorityLevels");e!==-1&&o.splice(e,1)}else o.find(a=>a.name==="priorityLevels")||o.splice(2,0,{name:"priorityLevels",label:"Status",align:"center",field:a=>r(a.severity),format:a=>`${a}`,sortable:!0});if(l.value<=550){const e=o.findIndex(a=>a.name==="notification");e!==-1&&o.splice(e,1)}else o.find(a=>a.name==="notification")||o.splice(1,0,{name:"notification",label:"Notification",align:"left",field:a=>a.SIEMNotificationName??"N/A"})};I(()=>l.value,()=>{h()},{immediate:!0});function u(e){t.page=e}const m=b("contextMenuSetter"),P=(e,a,T)=>{m({id:e,evt:T,route:"notification-details",routeName:"NotificationDetails",loadingMessage:"Redirecting to Notification Details..."})};function v(e){t.selectedAccountId=e.autotask_id}const N=s([]),{result:f,refetch:y,error:d,loading:k}=M(W,()=>({page:t.page,account_id:t.selectedAccountId===null?633:t.selectedAccountId,first:100}));_(()=>{k.value&&(t.searchLoading=!0),d.value&&console.log(d.value,"error"),f.value&&(t.searchLoading=!1,N.value=f.value.AccountNotifications.data,t.totalPages=f.value.AccountNotifications.paginatorInfo.lastPage)});function x(e){t.showComponentModal=e}const n=s([]),c=s(!1),{result:w,loading:Q}=M(j,()=>({first:20,companyName:i.getState.search,page:i.getState.page})),C=s("");return _(()=>{if(Q.value&&(c.value=!0),i.getState.search&&C.value!==i.getState.search&&(c.value=!0,n.value=[],C.value=i.getState.search),w.value){c.value=!1;let e=n.value;n.value=[...w.value.Companies.data,...n.value],i.setSpinner(n.value,e)}}),I(()=>i.getState,()=>{t.search=i.getState.search,t.page=i.getState.page},{deep:!0}),i.onSetValueCallback(v),{state:t,columns:o,pagination:g,setPage:u,handleRowClick:P,setAccountId:v,userNotifications:N,error:d,setComponentModal:x,refetch:y,isLoadingAccounts:c,accounts:n}}}),H={class:"q-px-lg mb-10",style:{width:"100%"}},U={class:"flex flex-col sm:flex-row relative mb-[-1rem]"},z={class:"w-full mt-4 sm:mt-0 sm:w-60 relative sm:absolute sm:top-0 sm:right-0"};function F(t,g,r,o,l,h){const u=S("SearchModel"),m=S("ListQTable");return V(),R("div",H,[A("div",U,[p(D,{class:"",color:"primary",icon:"add",label:"Create Account Notification","no-caps":"",to:"account/notification/create"}),A("div",z,[p(u,{label:"Accounts",value:"companyName",rows:t.accounts,loading:t.isLoadingAccounts,filled:"",dense:"","no-focus":""},null,8,["rows","loading"])])]),p(m,{title:"Notification List",rows:t.userNotifications,columns:t.columns,handleRowClick:t.handleRowClick,showPagination:!1,stateValue:t.state,setPage:t.setPage,loading:t.state.searchLoading,customNoDataText:"Searching for Account Notifications..."},null,8,["rows","columns","handleRowClick","stateValue","setPage","loading"])])}const Ne=$(q,[["render",F]]);export{Ne as default};
