import{a6 as ee,a7 as te,al as se,am as m,a9 as n,ac as p,ab as u,a8 as w,aa as $,af as o,ag as r,ae as B,Q as T,ah as k,aS as D,az as oe,aq as ae,aj as le,O as ie,E as j,au as P,aB as R,T as f,ax as z,ay as L,U as F}from"./index-D5yNAYFk.js";import{Q as ne}from"./QFile-UolSkRB9.js";import{Q,u as re,a as ue,U as de}from"./dark-mode-Cd1QLq0S.js";import{Q as me,L as pe}from"./ListQTable-DMWwlCDO.js";import{Q as fe}from"./QCard-CbW7iEIi.js";import{u as ce}from"./use-quasar-DBA3fETA.js";import{A as ve}from"./Account-D0LxHc_o.js";import{s as v}from"./search-BG39UB0l.js";import{I as be}from"./Introspection-Q8yMBvnq.js";import"./QChip-DHC18oyq.js";import"./use-key-composition-COT35ogy.js";import"./index-B22rUDyO.js";import"./parser-Dz45C1v8.js";import"./QSelect-BmmHhKDO.js";import"./QItemLabel-Cx7oXb7e.js";import"./QDialog-B5BoQEQA.js";import"./QToggle-DbLruOcG.js";import"./QMarkupTable-DvjuvEMf.js";import"./ClosePopup-1nkdbb7J.js";import"./QPagination-CnwpqxMf.js";import"./QSkeleton-CQslW_MF.js";import"./QSeparator-NQtf9fTk.js";const ge=te({components:{ListQTable:pe},setup(){const e=le(),t=ie("userData"),d=j(()=>t._id),O=j(()=>re().darkmode),a=P({editMode:"",name:"",title:"",company:"",bio:"",search:"",page:1,newAccountId:null,updateType:"",fileInput:null,avatarImage:null,hoveringPicture:!1,optOut:!1}),{result:b}=R(be,()=>({name:"User"})),g=f("");z(()=>{b.value&&(console.log(b.value,"introspectionData introspectionDataintrospectionData"),g.value=b.value.__type.fields.find(s=>s.name==="optOutOfAutoTimeEntries").description)});const l=f([]),{mutate:H,onError:K,onDone:q}=L(ue,()=>({variables:{_id:d.value,avatarImage:a.avatarImage}}));K(s=>{console.log(s,"error")}),q(s=>{console.log(s,"result")}),F(()=>d.value,()=>{e.path==="/user"&&(E("reset"),setTimeout(()=>{},1e3),setTimeout(()=>{E("create")},2e3))}),setTimeout(()=>{E("create")},3e3);function E(s){s==="reset"&&(a.title="",a.company="",a.name="",a.editMode=!1,a.newAccountId=null)}const{mutate:c,onError:G,onDone:W}=L(de,()=>a.updateType==="name"?{variables:{_id:d.value,name:a.name}}:a.updateType==="title"?{variables:{_id:d.value,title:a.title}}:a.updateType==="account"?{variables:{_id:d.value,AccountId:a.newAccountId}}:a.updateType==="bio"?{variables:{_id:d.value,bio:a.bio}}:a.updateType==="optOut"?{variables:{_id:d.value,optOutOfAutoTimeEntries:a.optOut}}:null);G(s=>{console.log(s,"error")}),W(s=>{console.log(s,"user updated info")});const U=f(null),A=f(null),h=f(null);function Y(s){a.editMode=s,s==="name"&&setTimeout(()=>{A.value&&A.value.focus()},10),s==="title"&&setTimeout(()=>{U.value&&U.value.focus()},10),s==="bio"&&setTimeout(()=>{h.value&&h.value.focus()},10)}function N(s,i){console.log(s,i,"id, value, setAccount"),s!==null&&s!=="close"?(a.newAccountId=s.id,a.company=s.companyName,V("account",s)):V("")}const I=ce();function M(s,i){s==="Company"?I.notify({message:s+" updated to "+a.company,color:"indigo-9"}):I.notify({message:s+" updated to "+i,color:"indigo-9"})}function V(s,i){s==="name"?i!=="TEST"&&(a.updateType="name",c(),M("Name",i)):s==="title"?i!=="TEST"&&(a.updateType="title",c(),M("Position",i)):s==="account"?i!=="TEST"&&(a.updateType="account",c(),M("Company",i)):s==="bio"?i!=="TEST"&&i!==null&&(a.updateType="bio",c()):s==="optOut"&&i!=="TEST"&&i!==null&&(a.updateType="optOut",c()),a.editMode=""}function J(){a.editMode=""}function X(s){return s._id==="62094badafec225c2239bc24"||s._id==="62094badafec225c2239bc1e"||s._id==="646f9db3fe0fd458120672bc"||s._id==="646f7252c23516d9f30569a3"?"https://png.pngitem.com/pimgs/s/142-1428108_settings-icon-png-transparent-png.png":s.avatar!==null?"https://ais-portal-s3-public.s3.amazonaws.com/"+s.avatar:"https://images.unsplash.com/photo-1511367461989-f85a21fda167?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1331&q=80"}function Z(){a.avatarImage=a.fileInput,console.log(a.fileInput,"fileInput updateUserAvatar"),H(),I.notify({color:"indigo",textColor:"white",icon:"cloud_done",message:"Avatar Updated"})}const C=f(!1),y=f([]),{result:S,loading:x}=R(ve,()=>({first:15,companyName:a.search,page:a.page}));z(()=>{if(x.value&&(C.value=!0),S.value){C.value=!1;let s=y.value;y.value=S.value.Companies.data,v.setSpinner(y.value,s)}}),F(()=>v.getState,()=>{a.search=v.getState.search,a.page=v.getState.page},{deep:!0}),v.onSetValueCallback(N);const _=P([{name:"name",align:"left",label:"Name",field:s=>s.name,format:s=>`${s}`,sortable:!0},{name:"Description",align:"left",label:"Description",field:s=>s.description??"N/A",format:s=>`${s}`}]);return{state:a,setEditMode:Y,updateUser:c,setAccountId:N,cancelEditing:V,titleInput:U,nameInput:A,setEditAccount:J,showImage:X,updateUserAvatar:Z,bioInput:h,accounts:y,isLoading:C,darkmode:O,autoTimeEntryTooltip:g,userRoles:l,columns:_}}}),ye={key:0,class:"intro-y box mt-0"},we={class:"flex items-center p-5 border-b border-slate-200/60 dark:border-slate-500"},Te={class:"font-medium text-base"},ke={class:"flex flex-col sm:flex-row items-end sm:items-center ml-10 justify-end w-full mt-[-1.5rem]"},Ee={class:"flex items-center"},Ue={class:"mt-1 text-slate-500 dark:text-slate-300"},Ae={class:"ml-10 mt-1 text-slate-500 dark:text-slate-300"},he={class:"pb-5 px-5 relative"},Ie={class:"grid grid-cols-2 md:grid-cols-3 flex justify-center gap-x-0 md:gap-x-5"},Me={class:"flex justify-center items-center"},Ve=["src"],Ce={class:"rounded-full absolute top-0 flex justify-center items-center left-0 z-10 w-full h-full edit-picture"},$e={key:0,class:"flex flex-col items-center justify-center"},De={class:"grid grid-cols-1 md:grid-cols-2 w-[45vw] sm:w-[55vw] md:w-[45vw]"},Qe={class:""},Oe={class:"mt-5"},Ne={class:"w-20"},Se={class:"mt-5"},Be={class:""},je={class:"mt-5"},Pe={class:"w-40"},Re={key:0,class:"w-60"},ze={class:"mt-5"},Le={class:"w-20"},Fe={class:"col-span-2"},He={class:"mt-5 flex flex-col w-full"},Ke={class:"text-slate-400"},qe={style:{"white-space":"pre-line"}},Ge={class:"mt-5 col-span-3 mx-5"},We={class:"text-slate-400 italic ml-5"},Ye={key:0,class:"mx-10 mt-10 dark:border-slate-500"};function Je(e,t,d,O,a,b){const g=se("ListQTable");return n(),m(ae,null,[p(fe,{class:B(["mx-10",e.darkmode?"bg-[#28334E] text-slate-300":"bg-white"])},{default:$(()=>[e.user?(n(),m("div",ye,[o("div",we,[o("h2",Te,r(e.user.User.name),1),o("div",ke,[o("div",Ee,[o("div",{class:B([e.user.User.Approved?"bg-primary":"bg-danger","w-2.5 h-2.5 rounded-full mt-1 mr-3"])},null,2),o("p",Ue,r(e.user.User.Approved?"Active":"Not Active"),1)]),o("p",Ae,r(e.user.User.Approved?"Client Portal Access Enabled":"Client Portal Access Disabled"),1)])]),o("div",he,[o("div",Ie,[o("div",Me,[o("div",{class:"w-32 h-32 rounded-full relative mt-3 mx-2 sm:mx-5 cursor-pointer",onMouseenter:t[1]||(t[1]=l=>e.state.hoveringPicture=!0),onMouseleave:t[2]||(t[2]=l=>e.state.hoveringPicture=!1)},[t[21]||(t[21]=o("div",{class:"bg-blue-400 w-full h-full p-[4.25rem] rounded-full absolute -left-1 -top-1 shadow-xl"},null,-1)),o("img",{class:"object-cover h-full w-full rounded-full relative",src:e.showImage(e.user.User)},null,8,Ve),o("div",Ce,[e.state.hoveringPicture?(n(),m("div",$e,[p(T,{name:"photo_camera",color:"grey-3",size:"lg",class:""}),t[20]||(t[20]=o("p",{class:"text-slate-100"},"Update",-1)),p(ne,{modelValue:e.state.fileInput,"onUpdate:modelValue":[t[0]||(t[0]=l=>e.state.fileInput=l),e.updateUserAvatar],dense:"",class:"w-full h-full absolute rounded-full cursor-pointer",color:"white",style:{opacity:"0"},borderless:"",dark:"","text-color":"white"},null,8,["modelValue","onUpdate:modelValue"])])):u("",!0)])],32)]),o("div",De,[o("div",Qe,[o("div",Oe,[o("label",{for:"update-profile-form-7",class:"text-slate-400 cursor-pointer hover:text-blue-500",onClick:t[3]||(t[3]=l=>e.setEditMode("name"))},[t[22]||(t[22]=k("User ",-1)),p(T,{name:"edit",class:"ml-2 mb-1"})]),o("div",Ne,[e.state.editMode!=="name"?(n(),m("p",{key:0,class:"cursor-pointer w-52",onClick:t[4]||(t[4]=l=>e.setEditMode("name"))},r(e.user.User.name),1)):u("",!0)]),e.state.editMode==="name"?(n(),w(Q,{key:0,id:"update-profile-form-7",ref:"nameInput",modelValue:e.state.name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.state.name=l),dark:e.darkmode,dense:"",filled:"",type:"text",class:"form-control w-2/3",onFocusout:t[6]||(t[6]=l=>e.cancelEditing("name",e.state.name)),onKeyup:t[7]||(t[7]=D(l=>e.cancelEditing("name",e.state.name),["enter"]))},null,8,["modelValue","dark"])):u("",!0)]),o("div",Se,[t[23]||(t[23]=o("label",{class:"text-slate-400"},"Email",-1)),o("p",null,r(e.user.User.email),1)])]),o("div",Be,[o("div",je,[t[24]||(t[24]=o("label",{class:"form-label text-slate-400 mb-1"},"Account ",-1)),o("div",Pe,[e.state.editMode!=="account"?(n(),m("p",Re,r(e.user.User.AccountName),1)):u("",!0)])]),o("div",ze,[o("label",{for:"update-profile-form-9",class:"text-slate-400 cursor-pointer hover:text-blue-500",onClick:t[8]||(t[8]=l=>e.setEditMode("title"))},[t[25]||(t[25]=k("Title ",-1)),p(T,{name:"edit",class:"ml-2 mb-1"})]),e.state.editMode==="title"?(n(),w(Q,{key:0,id:"update-profile-form-9",ref:"titleInput",modelValue:e.state.title,"onUpdate:modelValue":t[9]||(t[9]=l=>e.state.title=l),dark:e.darkmode,dense:"",filled:"",type:"text",class:"form-control w-2/3",placeholder:"Title",onFocusout:t[10]||(t[10]=l=>e.cancelEditing("title",e.state.title)),onKeyup:t[11]||(t[11]=D(l=>e.cancelEditing("title",e.state.title),["enter"]))},null,8,["modelValue","dark"])):u("",!0),o("div",Le,[e.state.editMode!=="title"?(n(),m("p",{key:0,class:"cursor-pointer w-52",onClick:t[12]||(t[12]=l=>e.setEditMode("title"))},r(e.user.User.title!==null?e.user.User.title:"N/A"),1)):u("",!0)])])]),o("div",Fe,[o("div",He,[o("label",Ke,[t[26]||(t[26]=k("Opt out of AutoTime Entries ",-1)),p(T,{name:"help",size:"xs",class:"ml-4 text-slate-500 hover:text-blue-400 transition-all duration-500"},{default:$(()=>[p(oe,{class:"text-sm bg-white shadow-md border w-80 text-slate-600 hover:text-blue-400"},{default:$(()=>[o("p",qe,r(e.autoTimeEntryTooltip),1)]),_:1})]),_:1})]),p(me,{modelValue:e.state.optOut,"onUpdate:modelValue":t[13]||(t[13]=l=>e.state.optOut=l),class:"break-keep w-full",label:e.state.optOut?"Time Entries  for Tickets and Tasks must be created manually":"Time Entries will be automatically created for Tickets and Tasks",onClick:t[14]||(t[14]=l=>e.cancelEditing("optOut",e.state.optOut))},null,8,["modelValue","label"])])])]),o("div",Ge,[o("label",{class:"text-slate-400 cursor-pointer",onClick:t[15]||(t[15]=l=>e.setEditMode("bio"))},"Bio"),e.state.editMode!=="bio"?(n(),m("p",{key:0,class:"cursor-pointer",onClick:t[16]||(t[16]=l=>e.setEditMode("bio"))},[k(r(e.user.User.bio!==null?e.user.User.bio:"N/A")+" ",1),o("span",We,r(e.user.User.bio!==null?"":"click to edit Bio or profile Picture"),1)])):(n(),w(Q,{key:1,id:"update-profile-form-9",ref:"bioInput",modelValue:e.state.bio,"onUpdate:modelValue":t[17]||(t[17]=l=>e.state.bio=l),dense:"",filled:"",type:"textarea",class:"form-control",placeholder:"Biography",onFocusout:t[18]||(t[18]=l=>e.cancelEditing("bio",e.state.bio)),onKeyup:t[19]||(t[19]=D(l=>e.cancelEditing("bio",e.state.bio),["enter"]))},null,8,["modelValue"]))])])])])):u("",!0)]),_:1},8,["class"]),e.user?(n(),m("hr",Ye)):u("",!0),e.user?(n(),w(g,{key:1,rows:e.userRoles,columns:e.columns,stateValue:e.state,title:"Roles",customNoDataText:"Searching for Roles...",shouldHideBottom:!0,superDense:!1,class:"mb-10 mx-10",showViewButton:!1,handleRowClick:e.deleteRole},null,8,["rows","columns","stateValue","handleRowClick"])):u("",!0)],64)}const yt=ee(ge,[["render",Je]]);export{yt as default};
